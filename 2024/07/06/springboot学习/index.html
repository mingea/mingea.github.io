<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>springboot学习 | 学习笔记</title><meta name="author" content="明"><meta name="copyright" content="明"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 springboot基本介绍 1.1 SpringBoot是什么两句话：  ​	Spring Boot 可以轻松创建独立的、生产级的基于Spring 的应用程序 ​    Spring Boot 直接嵌入 Tomcat、Jetty 或 Undertow ，可以”直接运行” SpringBoot 应用程序  1.2 SpringBoot快速入门构建一个 SpringBoot 项目，浏览器发送&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="springboot学习">
<meta property="og:url" content="http://example.com/2024/07/06/springboot%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="学习笔记">
<meta property="og:description" content="1 springboot基本介绍 1.1 SpringBoot是什么两句话：  ​	Spring Boot 可以轻松创建独立的、生产级的基于Spring 的应用程序 ​    Spring Boot 直接嵌入 Tomcat、Jetty 或 Undertow ，可以”直接运行” SpringBoot 应用程序  1.2 SpringBoot快速入门构建一个 SpringBoot 项目，浏览器发送&amp;#">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/butterfly-icon.png">
<meta property="article:published_time" content="2024-07-06T12:42:13.000Z">
<meta property="article:modified_time" content="2025-10-21T10:56:32.711Z">
<meta property="article:author" content="明">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "springboot学习",
  "url": "http://example.com/2024/07/06/springboot%E5%AD%A6%E4%B9%A0/",
  "image": "http://example.com/img/butterfly-icon.png",
  "datePublished": "2024-07-06T12:42:13.000Z",
  "dateModified": "2025-10-21T10:56:32.711Z",
  "author": [
    {
      "@type": "Person",
      "name": "明",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2024/07/06/springboot%E5%AD%A6%E4%B9%A0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'springboot学习',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">学习笔记</span></a><a class="nav-page-title" href="/"><span class="site-name">springboot学习</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">springboot学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-06T12:42:13.000Z" title="发表于 2024-07-06 20:42:13">2024-07-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-21T10:56:32.711Z" title="更新于 2025-10-21 18:56:32">2025-10-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%BC%80%E5%8F%91/">java开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>1 springboot基本介绍</p>
<h2 id="1-1-SpringBoot是什么"><a href="#1-1-SpringBoot是什么" class="headerlink" title="1.1 SpringBoot是什么"></a>1.1 SpringBoot是什么</h2><p><strong>两句话：</strong></p>
<ul>
<li>​	<strong>Spring Boot 可以轻松创建独立的、生产级的基于Spring 的应用程序</strong></li>
<li>​    <strong>Spring Boot 直接嵌入 Tomcat、Jetty 或 Undertow ，可以”直接运行” SpringBoot 应用程序</strong></li>
</ul>
<h2 id="1-2-SpringBoot快速入门"><a href="#1-2-SpringBoot快速入门" class="headerlink" title="1.2 SpringBoot快速入门"></a>1.2 SpringBoot快速入门</h2><p>构建一个 SpringBoot 项目，浏览器发送&#x2F;hello 请求 <code>http://localhost:8080/hello</code>，响应Hello:</p>
<p>这里目前学的的版本是SpringBoot2.7，maven3.6.3，jdk8</p>
<img src="1.jpg" style="zoom:50%;">

<img src="2.jpg" style="zoom: 50%;">

<p>创建好之后在pom文件中引入SpringBoot相关依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.wzb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quickstart<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 导入springboot父工程--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 导入web项目场景启动器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在com.wzb.springboot包中创建启动类Main,需要注解<code>@SpringBootApplication</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wzb.springboot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 启动SpringBoot项目</span></span><br><span class="line">        SpringApplication.run(Main.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>之后创建controller包，创建包下HelloController类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动项目后，默认端口是8080，访问<code>http://localhost:8080/hello</code>，可以发现 <code>hello</code> 字符串输出在了浏览器页面。</p>
<h3 id="1-2-1-小结"><a href="#1-2-1-小结" class="headerlink" title="1.2.1 小结"></a>1.2.1 小结</h3><ol>
<li>SpringBoot 比较传统的 SSM 开发， 简化整合步骤, 提高开发效率</li>
<li>简化了 Maven 项目的 pom.xml 依赖导入, 可以说是一键导入，如图</li>
</ol>
<img src="3.jpg" style="zoom: 33%;">

<p>​	3.内置 Tomcat , 简化服务器的配置</p>
<h2 id="1-3-SpringBoot与SpringMVC关系"><a href="#1-3-SpringBoot与SpringMVC关系" class="headerlink" title="1.3 SpringBoot与SpringMVC关系"></a>1.3 SpringBoot与SpringMVC关系</h2><h3 id="1-3-1-梳理关系"><a href="#1-3-1-梳理关系" class="headerlink" title="1.3.1 梳理关系"></a>1.3.1 梳理关系</h3><ul>
<li>他们的关系大概是: Spring Boot &gt; Spring &gt; Spring MVC</li>
<li>Spring MVC 只是 Spring 处理 WEB 层请求的一个模块&#x2F;组件, Spring MVC 的基石是Servlet</li>
<li>Spring 的核心是 IOC 和 AOP, IOC 提供了依赖注入的容器, AOP 解决了面向切面编程</li>
<li>Spring Boot 是为了简化开发, 推出的封神框架(约定优于配置[COC]，简化了Spring项目的配置流程), SpringBoot 包含很多组件&#x2F;框架，Spring就是最核心的内容之一，也包含SpringMVC</li>
<li>Spring 家族，有众多衍生框架和组件例如 boot、security、jpa 等, 他们的基础都是Spring</li>
</ul>
<h3 id="1-3-2-如何理解-约定优于配置"><a href="#1-3-2-如何理解-约定优于配置" class="headerlink" title="1.3.2 如何理解 -约定优于配置"></a>1.3.2 如何理解 -约定优于配置</h3><ol>
<li>约定优于配置(Convention over Configuration&#x2F;COC)，又称按约定编程，是一种软件设计规范, 本质上是对系统、类库或框架中一些东西假定一个大众化合理的默认值(缺省值)</li>
<li>例如在模型中存在一个名为 User 的类，那么对应到数据库会存在一个名为user 的表，只有在偏离这个约定时才需要做相关的配置 (例如你想将表名命名为t_user 等非user 时才需要写关于这个名字的配置)</li>
<li>简单来说就是假如你所期待的配置与约定的配置一致，那么就可以不做任何配置，约定不符合期待时, 才需要对约定进行替换配置</li>
<li>约定其实就是一种规范，遵循了规范，那么就存在通用性，存在通用性，那么事情就会变得相对简单，程序员之间的沟通成本会降低，工作效率会提升，合作也会变得更加简单</li>
</ol>
<h1 id="2-依赖管理和自动配置"><a href="#2-依赖管理和自动配置" class="headerlink" title="2 依赖管理和自动配置"></a>2 依赖管理和自动配置</h1><h2 id="2-1-依赖管理"><a href="#2-1-依赖管理" class="headerlink" title="2.1 依赖管理"></a>2.1 依赖管理</h2><h3 id="2-1-1-什么是依赖管理"><a href="#2-1-1-什么是依赖管理" class="headerlink" title="2.1.1 什么是依赖管理"></a>2.1.1 什么是依赖管理</h3><p>spring-boot-starter-parent 还有父项目, 声明了开发中常用的依赖的版本号，并且进行 自动版本仲裁 , 即如果程序员没有指定某个依赖jar 的版本，则以父项目指定的版本为准</p>
<p><img src="4.jpg"></p>
<img src="5.jpg" style="zoom:50%;">

<h3 id="2-1-2-修改自动仲裁-默认版本号"><a href="#2-1-2-修改自动仲裁-默认版本号" class="headerlink" title="2.1.2 修改自动仲裁&#x2F;默认版本号"></a>2.1.2 修改自动仲裁&#x2F;默认版本号</h3><p>需求说明: 将 SpringBoot mysql 驱动修改成 5.1.49</p>
<p><img src="6.jpg"></p>
<p>查看 spring-boot-dependencies.pom 里面规定当前依赖的版本对应的key , 这里是mysql.version</p>
<p><img src="7.jpg"></p>
<p>修改 springboot2\quickstart\pom.xml 重写配置, 当更新Maven 时，就依赖到新的mysql 驱动.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.49<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 导入 web 项目场景启动器,会自动导入和 web 开发相关依赖,非常方便--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 根据依赖就近优先原则，以自己指定的为准 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-starter-场景启动器"><a href="#2-2-starter-场景启动器" class="headerlink" title="2.2 starter 场景启动器"></a>2.2 starter 场景启动器</h2><h3 id="2-2-1-starter场景启动器基本介绍"><a href="#2-2-1-starter场景启动器基本介绍" class="headerlink" title="2.2.1 starter场景启动器基本介绍"></a>2.2.1 starter<strong>场景启动器基本介绍</strong></h3><p>1.<strong>开发中我们引入了相关场景的</strong>starter**，这个场景中所有的相关依赖都引入进来了，比如我们做<strong>web</strong>开发引入了，该<strong>starter</strong>将导入与<strong>web</strong>开发相关的所有包**</p>
<p>2.<strong>依赖树:可以看到spring-boot-starter-web，帮我们引入了spring-webmvc，spring-web开发模块，还引入了spring-boot-starter-tomcat场景，spring-boot-starter-json场景，这些场景下面又引入了一大堆相关的包，这些依赖项可以快速启动和运行一个项目，提高开发效率.</strong></p>
<p><img src="springboot%E5%AD%A6%E4%B9%A0%5C8.jpg"></p>
<p><strong>3.所有场景启动器最基本的依赖就是spring-boot-starter</strong></p>
<h3 id="2-2-2-官方提供的starter"><a href="#2-2-2-官方提供的starter" class="headerlink" title="2.2.2 官方提供的starter"></a>2.2.2 <strong>官方提供的</strong>starter</h3><p>1.<strong>在开发中我们经常会用到</strong>spring-boot-starter-xxx**，比如<strong>spring-boot-starter-web</strong>，该场景是用作<strong>web</strong>开发，也就是说<strong>xxx</strong>是某种开发场景。**</p>
<p>2.我们只要引入starter，这个场景的所有常规需要的依赖我们都自动引入。</p>
<h3 id="2-2-3-第三方starter"><a href="#2-2-3-第三方starter" class="headerlink" title="2.2.3 第三方starter"></a>2.2.3 <strong>第三方</strong>starter</h3><p>1.SpringBoot<strong>也支持第三方</strong>starter</p>
<p>2.第三方starter不要从spring-boot开始，因为这是官方spring-boot保留的命名方式的。第三方启动程序通常以项目名称开头。例如，名为thirdpartyproject的第三方启动程序项目通常被命名为thirdpartyproject-spring-boot-starter。</p>
<p>3.也就是说：xxx-spring-boot-starter是第三方为我们提供的简化开发的场景启动器</p>
<h2 id="2-3-自动配置"><a href="#2-3-自动配置" class="headerlink" title="2.3 自动配置"></a><strong>2.3</strong> 自动配置</h2><h3 id="2-3-1-自动配置功能"><a href="#2-3-1-自动配置功能" class="headerlink" title="2.3.1 自动配置功能"></a>2.3.1 自动配置功能</h3><p>1.SpringBoot<strong>自动配置</strong>Tomcat、SpringMVC、Web常用功能:比如字符过滤器等等</p>
<p>2.默认主程序所在的包及其子包下会被扫描</p>
<p><img src="springboot%E5%AD%A6%E4%B9%A0%5C9.jpg"></p>
<h3 id="2-3-2-如何修改默认扫描包结构"><a href="#2-3-2-如何修改默认扫描包结构" class="headerlink" title="2.3.2 如何修改默认扫描包结构"></a>2.3.2 <strong>如何修改默认扫描包结构</strong></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span>.com.wzb;</span><br><span class="line">importorg.springframework.stereotype.Controller; </span><br><span class="line">importorg.springframework.web.bind.annotation.RequestMapping; importorg.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*<span class="doctag">@author</span> wzb</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HiController</span>&#123;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hi&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hi</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span><span class="string">&quot;hi~,spring boot&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改MainApp.java,增加扫描的包,并完成测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//直接在	SpringBootApplication注解后指定</span></span><br><span class="line"><span class="meta">@SpringBootApplication(scanBasePackages=&quot;com.wzb&quot;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApp</span>&#123;<span class="comment">//.....</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-resources-application-properties-配置"><a href="#2-3-3-resources-application-properties-配置" class="headerlink" title="2.3.3 resources\application.properties 配置"></a>2.3.3 resources\application.properties 配置</h3><p>- SpringBoot 项目最重要也是最核心的配置文件就是 application.properties，所有的框架配置都可以在这个配置文件中说明</p>
<p>● 各 种 配 置 都 有 默 认 , 可 以 在 resources\application.properties 修改, application.properties 文件我们可以手动创建</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">#默认 server.port=8080</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">10000</span></span><br><span class="line"><span class="comment">#比如: 默认 spring.servlet.multipart.max-file-size=1MB</span></span><br><span class="line"><span class="comment">#该属性可以指定 springboot 上传文件大小的限制</span></span><br><span class="line"><span class="comment">#默认配置最终都是映射到某个类上,比如这里配置会映射到 MultipartProperties</span></span><br><span class="line"><span class="comment">#把光标放在该属性，ctrl+b 就可以定位该配置映射到的类</span></span><br><span class="line"><span class="attr">spring.servlet.multipart.max-file-size</span>=<span class="string">10MB</span></span><br></pre></td></tr></table></figure>

<p>常用配置</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">#端口号</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">10000</span></span><br><span class="line"><span class="comment">#应用的上下文路径(项目路径)</span></span><br><span class="line"><span class="attr">server.servlet.context-path</span>=<span class="string">/allModel</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis.type-aliases-package</span>=<span class="string">com.cxs.allmodel.model</span></span><br><span class="line"><span class="comment">#指定 mapper.xml 的路径</span></span><br><span class="line"><span class="comment">#(application 上配置了@MapperScan(扫面 mapper 类的路径)和 pom.xml 中放行了mapper.xml 后，# 配 置 mapper-locations 没 有 意 义 。 如 果 mapper 类 和 mapper.xml 不 在 同 一个路径下时，mapper-locations 就有用了)</span></span><br><span class="line"><span class="attr">mybatis.mapper-locations</span>=<span class="string">classpath:com/cxs/allmodel/mapper</span></span><br><span class="line"><span class="comment">#session 失效时间(单位 s)</span></span><br><span class="line"><span class="attr">spring.session.timeout</span>=<span class="string">18000</span></span><br><span class="line"><span class="comment">#数据库连接配置</span></span><br><span class="line"><span class="comment">#mysql 数据库 url</span></span><br><span class="line"><span class="attr">mysql.one.jdbc-url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/test?serverTimezone=Asia/Shanghai&amp;useSSL=false</span></span><br><span class="line"><span class="comment">#mysql 数据库用户名</span></span><br><span class="line"><span class="attr">mysql.one.username</span>=<span class="string"></span></span><br><span class="line"><span class="comment">#数据库密码</span></span><br><span class="line"><span class="attr">mysql.one.password</span>=<span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="attr">mysql.one.maximum-pool-size</span>=<span class="string">15</span></span><br><span class="line"><span class="comment">#日志打印:日志级别 trace&lt;debug&lt;info&lt;warn&lt;error&lt;fatal 默认级别为 info，即默认打印info 及其以上级别的日志</span></span><br><span class="line"><span class="comment">#logging.level 设置日志级别，后面跟生效的区域，比如 root 表示整个项目，也可以设置为某个包下，也可以具体到某个类名（日志级别的值不区分大小写）</span></span><br><span class="line"><span class="attr">logging.level.com.cxs.allmodel.</span>=<span class="string">debug</span></span><br><span class="line"><span class="attr">logging.level.com.cxs.allmodel.mapper</span>=<span class="string">debug</span></span><br><span class="line"><span class="attr">logging.level.org.springframework.web</span>=<span class="string">info</span></span><br><span class="line"><span class="attr">logging.level.org.springframework.transaction</span>=<span class="string">info</span></span><br><span class="line"><span class="attr">logging.level.org.apache.ibatis</span>=<span class="string">info</span></span><br><span class="line"><span class="attr">logging.level.org.mybatis</span>=<span class="string">info</span></span><br><span class="line"><span class="attr">logging.level.com.github.pagehelper</span> = <span class="string">info</span></span><br><span class="line"><span class="attr">logging.level.root</span>=<span class="string">info</span></span><br><span class="line"><span class="comment">#日志输出路径</span></span><br><span class="line"><span class="attr">logging.file</span>=<span class="string">/tmp/api/allmodel.log</span></span><br><span class="line"><span class="comment">#配置 pagehelper 分页插件</span></span><br><span class="line"></span><br><span class="line"><span class="attr">pagehelper.reasonable</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">pagehelper.supportMethodsArguments</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">pagehelper.params</span>=<span class="string">count=countSql</span></span><br><span class="line"><span class="comment">#jackson 时间格式化</span></span><br><span class="line"><span class="attr">spring.jackson.serialization.fail-on-empty-beans</span>=<span class="string">false</span></span><br><span class="line"><span class="comment">#指定日期格式，比如 yyyy-MM-dd HH:mm:ss，或者具体的格式化类的全限定名</span></span><br><span class="line"><span class="attr">spring.jackson.date-format</span>=<span class="string">yyyy-MM-dd HH:mm:ss</span></span><br><span class="line"><span class="comment">#指定日期格式化时区，比如 America/Los_Angeles 或者 GMT+10</span></span><br><span class="line"><span class="attr">spring.jackson.time-zone</span>=<span class="string">GMT+8</span></span><br><span class="line"><span class="comment">#设置统一字符集</span></span><br><span class="line"><span class="attr">spring.http.encoding.charset</span>=<span class="string">utf8</span></span><br><span class="line"><span class="comment">#redis 连接配置</span></span><br><span class="line"><span class="comment"># redis 所在主机 ip 地址</span></span><br><span class="line"><span class="attr">spring.redis.host</span>=<span class="string"></span></span><br><span class="line"><span class="comment">#redis 服务器密码</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#redis 服务器端口号</span></span><br><span class="line"><span class="attr">spring.redis.port</span>=<span class="string"></span></span><br><span class="line"><span class="comment">#redis 数据库的索引编号(0 到 15)</span></span><br><span class="line"><span class="attr">spring.redis.database</span>=<span class="string">14</span></span><br><span class="line"><span class="comment">## 连接池的最大活动连接数量，使用负值无限制</span></span><br><span class="line"><span class="comment">#spring.redis.pool.max-active=8</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 连接池的最大空闲连接数量，使用负值表示无限数量的空闲连接</span></span><br><span class="line"><span class="comment">#spring.redis.pool.max-idle=8</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 连接池最大阻塞等待时间，使用负值表示没有限制</span></span><br><span class="line"><span class="comment">#spring.redis.pool.max-wait=-1ms</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 最小空闲连接数量，使用正值才有效果</span></span><br><span class="line"><span class="comment">#spring.redis.pool.min-idle=0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## 是否启用 SSL 连接. ##spring.redis.ssl=false</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 连接超时，毫秒为单位</span></span><br><span class="line"><span class="comment">#spring.redis.timeout= 18000ms</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 集群模式下，集群最大转发的数量</span></span><br><span class="line"><span class="comment">#spring.redis.cluster.max-redirects=</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 集群模式下，逗号分隔的键值对（主机：端口）形式的服务器列表</span></span><br><span class="line"><span class="comment">#spring.redis.cluster.nodes=</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 哨兵模式下，Redis 主服务器地址</span></span><br><span class="line"><span class="comment">#spring.redis.sentinel.master=</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 哨兵模式下，逗号分隔的键值对（主机：端口）形式的服务器列表</span></span><br><span class="line"><span class="comment">#spring.redis.sentinel.nodes= 127.0.0.1:5050,127.0.0.1:5060</span></span><br></pre></td></tr></table></figure>

<p>自定义配置</p>
<p>● 还可以在 properties 文件中自定义配置，通过@Value(“${}”)获取对应属性值</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># application.properties 文件</span></span><br><span class="line"><span class="attr">my.website</span>=<span class="string">https://www.baidu.com</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//某个 Bean</span></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;my.website&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String bdUrl;</span><br></pre></td></tr></table></figure>

<p>SpringBoot 在哪配置读取 application.properites?打开 ConfigFileApplicationListener.java , 看一下源码</p>
<p><img src="springboot%E5%AD%A6%E4%B9%A0%5C10.jpg"></p>
<p>满足DEFAULT_SEARCH_LOCATIONS中的所有路径就可以了</p>
<h3 id="2-3-4-spring-boot-autoconfigure"><a href="#2-3-4-spring-boot-autoconfigure" class="headerlink" title="2.3.4 spring-boot-autoconfigure"></a>2.3.4 spring-boot-autoconfigure</h3><p>SpringBoot 所 有 的 自 动 配 置 功 能 都 在 spring-boot-autoconfigure 包</p>
<p>在 SpringBoot 的 自 动 配 置 包 , 一 般 是 XxxAutoConfiguration.java, 对应XxxxProperties.java</p>
<h1 id="3-容器功能"><a href="#3-容器功能" class="headerlink" title="3 容器功能"></a>3 容器功能</h1><h2 id="3-1-Spring-注入组件的注解"><a href="#3-1-Spring-注入组件的注解" class="headerlink" title="3.1 Spring 注入组件的注解"></a>3.1 Spring 注入组件的注解</h2><h3 id="3-1-1-Component、-Controller、-Service、-Repository"><a href="#3-1-1-Component、-Controller、-Service、-Repository" class="headerlink" title="3.1.1 @Component、@Controller、 @Service、@Repository"></a>3.1.1 @Component、@Controller、 @Service、@Repository</h3><p>这些在 Spring 中的传统注解仍然有效，通过这些注解可以给容器注入组件</p>
<h2 id="3-2-Configuration"><a href="#3-2-Configuration" class="headerlink" title="3.2 @Configuration"></a>3.2 @Configuration</h2><h3 id="3-2-1-应用实例"><a href="#3-2-1-应用实例" class="headerlink" title="3.2.1 应用实例"></a>3.2.1 应用实例</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@Configuration 标识这是一个配置类: 等价 配置文件</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanConfig</span> &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 1. <span class="doctag">@Bean</span> : 给容器中添加组件</span></span><br><span class="line"><span class="comment">* 2. monster01() : 默认方法名作为组件的 id</span></span><br><span class="line"><span class="comment">* 3. Monster: 返回类型就是组件类型, 返回的值就是 new Monster(100, &quot;牛魔王&quot;, 500, &quot;芭蕉扇&quot;)</span></span><br><span class="line"><span class="comment">* 4. <span class="doctag">@Bean</span>(&quot;monster_nmw&quot;): 重新指定组件的 id = “monster_nmw”</span></span><br><span class="line"><span class="comment">* 5. 配置类里面使用<span class="doctag">@Bean</span> 标注在方法上给容器注册组件，默认是单实例的*/</span></span><br><span class="line"><span class="comment">// @Bean(&quot;monster_nmw&quot;)</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Monster <span class="title function_">monster01</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Monster</span>(<span class="number">100</span>, <span class="string">&quot;牛魔王&quot;</span>, <span class="number">500</span>, <span class="string">&quot;芭蕉扇&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改 MainApp.java , 从配置文件&#x2F;容器获取 bean , 并完成测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//启动 SpringBoot 应用程序</span></span><br><span class="line"><span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span></span><br><span class="line">SpringApplication.run(MainApp.class, args);</span><br><span class="line"><span class="comment">// //查看容器里面的组件</span></span><br><span class="line"><span class="comment">// String[] beanDefinitionNames = ioc.getBeanDefinitionNames();</span></span><br><span class="line"><span class="comment">// for (String beanDefinitionName : beanDefinitionNames) &#123;</span></span><br><span class="line"><span class="comment">// System.out.println(beanDefinitionName);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1. ioc.getBean(&quot;monster01&quot;, Monster.class) 是从 BeanConfig 配置类/容器获取bean实例</span></span><br><span class="line"><span class="comment">//2. 默认是单列模式, 所以 monster01 == monster02</span></span><br><span class="line"><span class="comment">//获取 BeanConfig 配置类的组件/bean 实例</span></span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster01</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;monster01&quot;</span>, Monster.class);</span><br><span class="line">System.out.println(monster01);</span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster02</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;monster01&quot;</span>, Monster.class);</span><br><span class="line">System.out.println(monster01 == monster02);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-Configuration-注意事项和细节"><a href="#3-2-2-Configuration-注意事项和细节" class="headerlink" title="3.2.2 @Configuration 注意事项和细节"></a>3.2.2 @Configuration 注意事项和细节</h3><ol>
<li>配置类本身也是组件， 因此也可以获取, 测试 修改</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span></span><br><span class="line">SpringApplication.run(MainApp.class, args);</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. ioc.getBean(&quot;monster01&quot;, Monster.class) 是从 BeanConfig 配置类/容器获取bean实例//2. 默认是单列模式, 所以 monster01 == monster02</span></span><br><span class="line"><span class="comment">//获取 BeanConfig 配置类的组件/bean 实例</span></span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster01</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;monster01&quot;</span>, Monster.class);</span><br><span class="line">System.out.println(monster01);</span><br><span class="line">韩顺平Java 工程师<span class="type">Monster</span> <span class="variable">monster02</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;monster01&quot;</span>, Monster.class);</span><br><span class="line">System.out.println(monster01 == monster02);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置类本身也是组件， 因此也可以获取</span></span><br><span class="line"><span class="type">BeanConfig</span> <span class="variable">beanConfig</span> <span class="operator">=</span> ioc.getBean(BeanConfig.class);</span><br><span class="line">System.out.println(<span class="string">&quot;beanConfig= &quot;</span> + beanConfig);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.SpringBoot2 新增特性： proxyBeanMethods 指定 Full 模式和Lite 模式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> wzb</span></span><br><span class="line"><span class="comment">* 1. proxyBeanMethods：代理 bean 的方法</span></span><br><span class="line"><span class="comment">* (1) Full(proxyBeanMethods = true)、【保证每个<span class="doctag">@Bean</span> 方法被调用多少次返回的组件都是单实例的, 是代理方式】</span></span><br><span class="line"><span class="comment">* (2) Lite(proxyBeanMethods = false)【每个<span class="doctag">@Bean</span> 方法被调用多少次返回的组件都是新创建的, 是非代理方式】</span></span><br><span class="line"><span class="comment">* (3) 特别说明: proxyBeanMethods 是在 调用<span class="doctag">@Bean</span> 方法 才生效，因此，需要先获取BeanConfig 组件，再调用方法</span></span><br><span class="line"><span class="comment">* 而不是直接通过 SpringBoot 主程序得到的容器来获取bean, 注意观察直接通过ioc.getBean() 获取 Bean, proxyBeanMethods 值并没有生效</span></span><br><span class="line"><span class="comment">* (4) 如何选择: 组件依赖必须使用 Full 模式默认。如果不需要组件依赖使用Lite 模* (5) Lite 模 也称为轻量级模式，因为不检测依赖关系，运行速度快*/</span></span><br><span class="line"><span class="comment">//@Configuration 标识这是一个配置类: 等价 配置文件</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanConfig</span> &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 1. <span class="doctag">@Bean</span> : 给容器中添加组件</span></span><br><span class="line"><span class="comment">* 2. monster01() : 默认方法名作为组件的 id</span></span><br><span class="line"><span class="comment">* 3. Monster: 返回类型就是组件类型, 返回的值就是 new Monster(100, &quot;牛魔王&quot;, 500, &quot;芭蕉扇&quot;)</span></span><br><span class="line"><span class="comment"> 4. <span class="doctag">@Bean</span>(&quot;monster_nmw&quot;): 重新指定组件的 id = “monster_nmw” * 5. 配置类里面使用<span class="doctag">@Bean</span> 标注在方法上给容器注册组件，默认是单实例的*/</span></span><br><span class="line"><span class="comment">// @Bean(&quot;monster_nmw&quot;)</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Monster <span class="title function_">monster01</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Monster</span>(<span class="number">100</span>, <span class="string">&quot;牛魔王&quot;</span>, <span class="number">500</span>, <span class="string">&quot;芭蕉扇&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.hspedu.springboot;</span><br><span class="line"><span class="keyword">import</span> com.hspedu.springboot.bean.Monster;</span><br><span class="line"><span class="keyword">import</span> com.hspedu.springboot.config.BeanConfig;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ConfigurableApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication(scanBasePackages = &quot;com.hspedu&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApp</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//启动 SpringBoot 应用程序</span></span><br><span class="line"><span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span></span><br><span class="line">SpringApplication.run(MainApp.class, args);</span><br><span class="line"><span class="comment">// //查看容器里面的组件</span></span><br><span class="line"><span class="comment">// String[] beanDefinitionNames = ioc.getBeanDefinitionNames();</span></span><br><span class="line"><span class="comment">// for (String beanDefinitionName : beanDefinitionNames) &#123;</span></span><br><span class="line"><span class="comment">// System.out.println(beanDefinitionName);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1. ioc.getBean(&quot;monster01&quot;, Monster.class) 是从 BeanConfig 配置类/容器获取bean实例</span></span><br><span class="line"><span class="comment">//2. 默认是单列模式, 所以 monster01 == monster02</span></span><br><span class="line"><span class="comment">//获取 BeanConfig 配置类的组件/bean 实例</span></span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster01</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;monster01&quot;</span>, Monster.class);</span><br><span class="line">System.out.println(monster01);</span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster02</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;monster01&quot;</span>, Monster.class);</span><br><span class="line">System.out.println(monster01 == monster02);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置类本身也是组件， 因此也可以获取</span></span><br><span class="line"><span class="type">BeanConfig</span> <span class="variable">beanConfig</span> <span class="operator">=</span> ioc.getBean(BeanConfig.class);</span><br><span class="line">System.out.println(<span class="string">&quot;beanConfig= &quot;</span> + beanConfig);</span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster03</span> <span class="operator">=</span> beanConfig.monster01();</span><br><span class="line"><span class="type">Monster</span> <span class="variable">monster04</span> <span class="operator">=</span> beanConfig.monster01();</span><br><span class="line">System.out.println(<span class="string">&quot;monster03 == monster04 : &quot;</span> + (monster03 == monster04));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-Import"><a href="#3-3-Import" class="headerlink" title="3.3 @Import"></a>3.3 @Import</h2><p>@Import 方式注入的组件, 默认组件的名字就是全类名</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;Dog.class, Cat.class&#125;)</span></span><br><span class="line"><span class="comment">// @Configuration//标识这是一个配置类: 等价 配置文件</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanConfig</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-4-Conditional"><a href="#3-4-Conditional" class="headerlink" title="3.4 @Conditional"></a>3.4 @Conditional</h2><h3 id="3-4-1-Conditional-介绍"><a href="#3-4-1-Conditional-介绍" class="headerlink" title="3.4.1 @Conditional 介绍"></a>3.4.1 @Conditional 介绍</h3><p>​	1. 条件装配：满足 Conditional 指定的条件，则进行组件注入</p>
<ol start="2">
<li>@Conditional 是一个根注解，下面有很多扩展注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//@ConditionalOnBean(name=&quot;monster02&quot;) 如果是在类中，代表所有的Bean都满足条件，需要monster02这个Bean存在于spring容器中</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanConfig2</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Monster <span class="title function_">monster02</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Monster</span>(<span class="string">&quot;小怪兽&quot;</span>, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建Dog对象，并返回给容器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@ConditionalOnBean</span>(name=&quot;monster02&quot;)当容器中有 monster02 Bean时，就注入dog01这个bean</span></span><br><span class="line"><span class="comment">     *     <span class="doctag">@ConditionalOnMissingBean</span>,在容器中没有 monster02 Bean时，就注入dog01这个bean</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean(name=&quot;monster02&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Dog <span class="title function_">dog01</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;小狗&quot;</span>, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-5-ImportResource"><a href="#3-5-ImportResource" class="headerlink" title="3.5 @ImportResource"></a>3.5 @ImportResource</h2><p>作用：原生配置文件引入, 也就是可以直接导入 Spring 传统的beans.xml ，可以认为是 SpringBoot 对 Spring 容器文件的兼容</p>
<p>将 beans.xml 导入到 BeanConfig.java 配置类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// 可以获取beans.xml中的bean</span></span><br><span class="line"><span class="meta">@ImportResource(&quot;classpath:beans.xml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanConfig3</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-6-配置绑定"><a href="#3-6-配置绑定" class="headerlink" title="3.6 配置绑定"></a>3.6 配置绑定</h2><p>一句话：使用 Java 读取到 SpringBoot 核心配置文件 application.properties 的内容，并且把它封装到 JavaBean 中</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 1. <span class="doctag">@Component</span> 将 Furn 注册为一个组件</span></span><br><span class="line"><span class="comment">* 2. <span class="doctag">@ConfigurationProperties</span>(prefix = &quot;furn01&quot;) 指定在 application.properties 前缀* 这样 Furn 组件就会属性文件中的 值绑定了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;furn01&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Furn</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Double price;</span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> Double <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> price;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPrice</span><span class="params">(Double price)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.price = price;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3. 修改 HelloController.java</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">package</span> com.hspedu.springboot.controller;</span><br><span class="line"><span class="keyword">import</span> com.hspedu.springboot.bean.Furn;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;hello, spring boot&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">Furn furn;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/furn&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Furn <span class="title function_">furn</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span> furn;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置绑定还有第 2 种方式,效果一样，注意: 注销@Component 需 要 在 BeanConfig.java( 也可以是其它配置类) 配置@EnableConfigurationProperties(Furn.class), 否则会提示错误</p>
<p><img src="springboot%E5%AD%A6%E4%B9%A0%5C11.jpg"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@EnableConfigurationProperties(Furn.class)解读</span></span><br><span class="line"><span class="comment">//1、开启 Furn 配置绑定功能</span></span><br><span class="line"><span class="comment">//2、把 Furn 组件自动注册到容器中</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(Furn.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanConfig</span> &#123;</span><br></pre></td></tr></table></figure>

<h1 id="4-Lombok"><a href="#4-Lombok" class="headerlink" title="4 Lombok"></a>4 Lombok</h1><h2 id="4-1-Lomkbok的作用"><a href="#4-1-Lomkbok的作用" class="headerlink" title="4.1 Lomkbok的作用"></a>4.1 Lomkbok的作用</h2><ol>
<li>简化 JavaBean 开发, 可以使用 Lombok 的注解让代码更加简洁</li>
<li>Java 项目中，很多没有技术含量又必须存在的代码：POJO 的getter&#x2F;setter&#x2F;toString；异常处理；I&#x2F;O 流的关闭操作等等，这些代码既没有技术含量，又影响着代码的美观，Lombok应运而生</li>
</ol>
<h2 id="4-2-Lomkbok常用注解"><a href="#4-2-Lomkbok常用注解" class="headerlink" title="4.2 Lomkbok常用注解"></a>4.2 Lomkbok常用注解</h2><ul>
<li><code>@Data</code>: 注解在类上;提供类所有属性的 aetting 和 seting 方法，此外还提供了equals、canEaual、hashCode、toString方法</li>
<li><code>@Setter</code>:注解在属性上;为属性提供 setting 方法</li>
<li><code>@Gettter</code> :注解在属性上;为属性提供 getting 方法</li>
<li><code>@Log4j</code>:注解在类上;为类提供一个 属性名为log 的 log4j日志对象</li>
<li><code>@NoArgsConstructor</code>:注解在类上;为类提供一个无参的构造方法</li>
<li><code>@AllArgsConstructor</code>:注解在类上;为类提供一个全参的构造方法</li>
<li><code>@Cleanup</code>:可以关闭流</li>
<li><code>@Builder</code>: 被注解的类加个构造者模式</li>
<li><code>@Synchronized</code> :加个同步锁</li>
<li><code>@SneakyThrows</code>:等同于try&#x2F;catch 捕获异常</li>
<li><code>@NonNull</code>:如果给参数加个这个注解 参数为null会抛出空指针异常</li>
<li><code>@Value</code>:注解和@Data类似，区别在于它会把所有成员变量默认定义为private final修饰，并且不会生成set方法。</li>
</ul>
<h2 id="4-3-Lombok应用"><a href="#4-3-Lombok应用" class="headerlink" title="4.3 Lombok应用"></a>4.3 Lombok应用</h2><p>在 pom.xml 引入 lombok，springboot会自动引入该依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引 入 lombok, 版 本 在 spring-boot-dependencies-2.5.3.pom指定了, 把光标放在lombok ctrl+b 可以看到--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@ToString : lombok 注解, 会在编译时生成 toString()</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="comment">//@Data: lombok 注解, 会在编译时生成 setter / getter</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="comment">//@NoArgsConstructor:lombok 注解, 会在编译时生成无参构造器@NoArgsConstructor</span></span><br><span class="line"><span class="comment">//@AllArgsConstructor: lombok 注解, 会在编译时生成全参构造器@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;furn01&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Furn</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Double price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>支持日志输出，建议使用@Slf4j</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;hello, spring boot&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">Furn furn;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/furn&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Furn <span class="title function_">furn</span><span class="params">()</span> &#123;</span><br><span class="line">log.info(<span class="string">&quot;furn = &quot;</span> + furn);</span><br><span class="line"><span class="comment">//占位用法</span></span><br><span class="line">log.info(<span class="string">&quot;furn = &#123;&#125; &quot;</span>, furn);</span><br><span class="line"><span class="keyword">return</span> furn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-yaml"><a href="#5-yaml" class="headerlink" title="5 yaml"></a>5 yaml</h1><h2 id="5-1-yaml介绍"><a href="#5-1-yaml介绍" class="headerlink" title="5.1 yaml介绍"></a>5.1 yaml介绍</h2><p>1、YAML 以数据做为中心，而不是以标记语言为重点</p>
<p>2、YAML 仍然是一种标记语言, 但是和传统的标记语言不一样, 是以数据为中心的标记语言.</p>
<p>3、YAML 非常适合用来做以数据为中心的配置文件 [springboot : application.yml]</p>
<h2 id="5-2-yaml基本语法"><a href="#5-2-yaml基本语法" class="headerlink" title="5.2 yaml基本语法"></a>5.2 yaml基本语法</h2><ol>
<li>形式为 key: value；注意: 后面有空格 </li>
<li>区分大小写 </li>
<li>使用缩进表示层级关系 </li>
<li>缩进不允许使用 tab，只允许空格 [有些地方也识别 tab , 推荐使用空格] </li>
<li>缩进的空格数不重要，只要相同层级的元素左对齐即可 </li>
<li>字符串无需加引号</li>
<li>yml 中, 注释使用 #</li>
</ol>
<h2 id="5-3-数据类型"><a href="#5-3-数据类型" class="headerlink" title="5.3 数据类型"></a>5.3 数据类型</h2><h3 id="5-3-1-字面量"><a href="#5-3-1-字面量" class="headerlink" title="5.3.1 字面量"></a>5.3.1 字面量</h3><p>字面量：单个的、不可再分的值。date、boolean、string、number、null</p>
<p>保存形式为 key: value</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">monster:</span></span><br><span class="line">	<span class="attr">id:</span> <span class="number">100</span></span><br><span class="line">	<span class="attr">name:</span> <span class="string">xxx</span></span><br><span class="line">	<span class="attr">age:</span> <span class="number">50</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-2-对象"><a href="#5-3-2-对象" class="headerlink" title="5.3.2 对象"></a>5.3.2 对象</h3><p>对象：键值对的集合, 比如 map、hash、set、object</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 行内写法： k: &#123;k1:v1,k2:v2,k3:v3&#125;</span></span><br><span class="line"><span class="attr">monster:</span> &#123;<span class="attr">id:</span> <span class="number">100</span>,<span class="attr">name:</span> <span class="string">牛魔王</span>&#125;</span><br><span class="line"><span class="comment">#或换行形式</span></span><br><span class="line"><span class="attr">k:</span></span><br><span class="line">	<span class="attr">k1:</span> <span class="string">v1</span></span><br><span class="line">	<span class="attr">k2:</span> <span class="string">v2</span></span><br><span class="line">	<span class="attr">k3:</span> <span class="string">v3</span></span><br><span class="line"><span class="attr">monster:</span> <span class="comment"># 可以是对象</span></span><br><span class="line">    <span class="attr">id:</span> <span class="number">100</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">牛魔王</span></span><br><span class="line"><span class="attr">skill:</span> <span class="comment"># 可以是String[]或者List&lt;String&gt;</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">飞</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">跑</span></span><br><span class="line"><span class="attr">hobby:</span> [<span class="string">喝酒，吃肉</span>]</span><br><span class="line"><span class="attr">brand:</span> &#123;<span class="attr">key01:</span> <span class="string">小米</span>,<span class="attr">key02:</span> <span class="string">比亚迪</span> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-3-数组"><a href="#5-3-3-数组" class="headerlink" title="5.3.3 数组"></a>5.3.3 数组</h3><p>数组：一组按次序排列的值, 比如 array、list、queue</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">行内写法：</span> <span class="attr">k:</span> [<span class="string">v1</span>,<span class="string">v2</span>,<span class="string">v3</span>]</span><br><span class="line"><span class="attr">hobby:</span> [<span class="string">打篮球</span>, <span class="string">打乒乓球</span>, <span class="string">踢足球</span>]</span><br><span class="line"><span class="comment">#或者换行格式</span></span><br><span class="line"><span class="attr">k:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">v1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">v2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">v3</span></span><br><span class="line"><span class="attr">hobby:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">打篮球</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">打乒乓球</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">踢足球</span></span><br></pre></td></tr></table></figure>

<h2 id="5-4-yaml-使用细节"><a href="#5-4-yaml-使用细节" class="headerlink" title="5.4 yaml 使用细节"></a>5.4 yaml 使用细节</h2><p>如 果 application.properties 和 application.yaml 有 相同的前缀值绑定，则application.properties 优先级高, 开发时，应当避免</p>
<h1 id="6-静态资源访问"><a href="#6-静态资源访问" class="headerlink" title="6 静态资源访问"></a>6 静态资源访问</h1><h3 id="6-1-基本介绍"><a href="#6-1-基本介绍" class="headerlink" title="6.1 基本介绍"></a>6.1 基本介绍</h3><p>只要静态资源放在类路径下： &#x2F;static 、 &#x2F;public 、 &#x2F;resources 、&#x2F;META-INF&#x2F;resources可以被直接访问- 对应文件 WebProperties.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS=&#123; <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>, <span class="string">&quot;classpath:/resources/&quot;</span>, <span class="string">&quot;classpath:/static/&quot;</span>, <span class="string">&quot;classpath:/public/&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>

<p>常见静态资源：JS、CSS 、图片（.jpg .png .gif .bmp .svg）、字体文件(Fonts)等</p>
<p>访问方式 ：默认: 项目根路径&#x2F; + 静态资源名 比如 <code>http://localhost:8080/hi.jpg .</code> </p>
<h3 id="6-2-使用注意"><a href="#6-2-使用注意" class="headerlink" title="6.2 使用注意"></a>6.2 使用注意</h3><p>问题：静态资源访问原理：静态映射是 &#x2F;** , 也就是对所有请求拦截，请求进来，先看Controller能不能处理，不能处理的请求交给静态资源处理器，如果静态资源找不到则响应404页面</p>
<p>改变静态资源访问前缀，比如我们希望 <code>http://localhost:8080/wzb/*</code> 去请求静态资源, 应用场景：静态资源访问前缀和控制器请求路径冲突</p>
<p>需要在配置文件中配置</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">mvc:</span></span><br><span class="line">		<span class="attr">static-path-pattern:</span> <span class="string">/wzb/**</span></span><br></pre></td></tr></table></figure>

<p>改变默认的静态资源路径，比如希望在类路径下增加 wzbimg 目录作为静态资源路径, 也就是希望resources目录下可以访问wzbimg中的资源</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">mvc:</span></span><br><span class="line">		<span class="attr">static-path-pattern:</span> <span class="string">/hspres/**</span></span><br><span class="line"><span class="attr">web:</span></span><br><span class="line">	<span class="attr">resources:</span></span><br><span class="line">		<span class="attr">static-locations:</span> [<span class="string">classpath:/wzbimg/</span>, <span class="string">classpath:/public/</span>, <span class="string">classpath:/static/</span>] <span class="comment"># 必须把public static目录带上，否则原来等等静态目录访问不上</span></span><br></pre></td></tr></table></figure>

<h1 id="7-Rest风格请求处理"><a href="#7-Rest风格请求处理" class="headerlink" title="7 Rest风格请求处理"></a>7 Rest风格请求处理</h1><h2 id="7-1-基本介绍"><a href="#7-1-基本介绍" class="headerlink" title="7.1 基本介绍"></a>7.1 基本介绍</h2><p>Rest 风格支持（使用 HTTP 请求方式动词来表示对资源的操作）</p>
<p>举例说明： </p>
<p>● 请求方式: &#x2F;monster </p>
<p>● GET-获取怪物 </p>
<p>● DELETE-删除怪物 </p>
<p>● PUT-修改怪物 </p>
<p>● POST-保存妖怪</p>
<p>7.2 应用实例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MonsterController</span> &#123;</span><br><span class="line"><span class="comment">// @RequestMapping(value = &quot;/monster&quot;,method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/monster&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getMonster</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;GET-查询妖怪&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// @RequestMapping(value = &quot;/monster&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/monster&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">saveMonster</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;POST-添加妖怪&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// @RequestMapping(value = &quot;/monster&quot;,method = RequestMethod.PUT)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/monster&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">putMonster</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;PUT-修改妖怪&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/monster&quot;)</span></span><br><span class="line"><span class="comment">// @RequestMapping(value = &quot;/monster&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">deleteMonster</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;DELETE-删除妖怪&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-2-注意事项和细节"><a href="#7-2-注意事项和细节" class="headerlink" title="7.2 注意事项和细节"></a>7.2 注意事项和细节</h2><p>1、客户端是 PostMan 可以直接发送 Put、delete 等方式请求，可不设置Filter </p>
<p>2、如果要 SpringBoot 支持 页面表单的 Rest 功能, 则需要注意如下细节</p>
<ul>
<li>Rest 风 格 请 求 核 心 Filter ； HiddenHttpMethodFilter ，表单请求会被HiddenHttpMethodFilter 拦截 , 获取到表单 _method 的值，再判断是PUT&#x2F;DELETE&#x2F;PATCH(注释: PATCH 方法是新引入的，是对 PUT 方法的补充，用来对已知资源进行局部更新) </li>
<li>如果要 SpringBoot 支持 页面表单的 Rest 功能, 需要在 application.yml 启用filter 功能, 否则无效 </li>
<li>修改 application.yml 启用 filter 功能</li>
</ul>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring</span>:<span class="string"></span></span><br><span class="line">	<span class="attr">mvc</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">static-path-pattern</span>: <span class="string">/wzb/**</span></span><br><span class="line">    <span class="attr">hiddenmethod</span>:<span class="string"></span></span><br><span class="line">        <span class="attr">filter</span>:<span class="string"></span></span><br><span class="line">			<span class="attr">enabled</span>: <span class="string">true #开启页面表单的 Rest 功能</span></span><br></pre></td></tr></table></figure>

<p>3、 @ResController 是一个复合注解, 含有@ResponseBody, 所以springboot 底层(springmvc), 在处理，如果单纯用@Controller注解，就不会返回数据给客户端，而是找视图解析器处理，比如return “test”，就会找<code>test.html</code>静态页面</p>
<p>解决方法：如果已经有了对应的test.html，可以在配置文件进行配置，返回“test”字符串也可以找到页面</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">spring:</span><br><span class="line">  mvc:</span><br><span class="line">    <span class="keyword">static</span>-path-pattern: /wzb<span class="comment">/**</span></span><br><span class="line"><span class="comment">    hiddenmethod:</span></span><br><span class="line"><span class="comment">      filter:</span></span><br><span class="line"><span class="comment">    enabled: true #开启页面表单的 Rest 功能</span></span><br><span class="line"><span class="comment">    view:</span></span><br><span class="line"><span class="comment">      prefix: / # 找根路径</span></span><br><span class="line"><span class="comment">      suffix: .html # 结尾是以.html结尾</span></span><br></pre></td></tr></table></figure>

<h1 id="8-接收参数相关注解"><a href="#8-接收参数相关注解" class="headerlink" title="8 接收参数相关注解"></a>8 接收参数相关注解</h1><h2 id="8-1-基本介绍"><a href="#8-1-基本介绍" class="headerlink" title="8.1 基本介绍"></a>8.1 基本介绍</h2><h3 id="1-PathVariable"><a href="#1-PathVariable" class="headerlink" title="1. @PathVariable"></a>1. @PathVariable</h3><p>作用：从URL路径中提取变量值。</p>
<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 基本使用</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.findById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 指定名称</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;userId&#125;/orders/&#123;orderId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Order <span class="title function_">getOrder</span><span class="params">(<span class="meta">@PathVariable(&quot;userId&quot;)</span> Long uid, </span></span><br><span class="line"><span class="params">                         <span class="meta">@PathVariable(&quot;orderId&quot;)</span> Long oid)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> orderService.findOrder(uid, oid);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用正则表达式</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;name:[a-z-]+&#125;-&#123;version:\\d\\.\\d\\.\\d&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getVersion</span><span class="params">(<span class="meta">@PathVariable</span> String name, </span></span><br><span class="line"><span class="params">                            <span class="meta">@PathVariable</span> String version)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name + <span class="string">&quot;:&quot;</span> + version;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取所有路径变量</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;type&#125;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getAllPathVariables</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@PathVariable</span> Map&lt;String, String&gt; pathVars)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pathVars;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-RequestHeader"><a href="#2-RequestHeader" class="headerlink" title="2. @RequestHeader"></a>2. @RequestHeader</h3><p>作用：从HTTP请求头中提取值。</p>
<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeaderController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取单个请求头</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/header&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getHeader</span><span class="params">(<span class="meta">@RequestHeader(&quot;User-Agent&quot;)</span> String userAgent)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User-Agent: &quot;</span> + userAgent;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置默认值</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/language&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getLanguage</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestHeader(value = &quot;Accept-Language&quot;, defaultValue = &quot;zh-CN&quot;)</span> String lang)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Language: &quot;</span> + lang;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取数值类型的请求头</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/content-length&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContentLength</span><span class="params">(<span class="meta">@RequestHeader(&quot;Content-Length&quot;)</span> <span class="type">long</span> contentLength)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Content-Length: &quot;</span> + contentLength;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取所有请求头</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/all-headers&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getAllHeaders</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestHeader</span> Map&lt;String, String&gt; headers)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> headers;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取多值请求头</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/multi-header&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getMultiValueHeader</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestHeader(&quot;Accept&quot;)</span> List&lt;String&gt; acceptHeaders)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> acceptHeaders;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-ModelAttribute"><a href="#3-ModelAttribute" class="headerlink" title="3. @ModelAttribute"></a>3. @ModelAttribute</h3><p>作用：将请求参数绑定到模型对象。</p>
<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ModelController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 自动绑定到对象</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createUser</span><span class="params">(<span class="meta">@ModelAttribute</span> User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User: &quot;</span> + user.getName() + <span class="string">&quot;, Age: &quot;</span> + user.getAge();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 在方法级别使用，为所有请求添加公共属性</span></span><br><span class="line">    <span class="meta">@ModelAttribute</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCommonAttributes</span><span class="params">(Model model)</span> &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;currentTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 自定义属性名</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/product&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getProduct</span><span class="params">(<span class="meta">@ModelAttribute(&quot;prod&quot;)</span> Product product)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> product.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对应的实体类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 构造方法、getter、setter</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, Integer age, String email)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// getter和setter方法</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123; <span class="built_in">this</span>.name = name; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getAge</span><span class="params">()</span> &#123; <span class="keyword">return</span> age; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(Integer age)</span> &#123; <span class="built_in">this</span>.age = age; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getEmail</span><span class="params">()</span> &#123; <span class="keyword">return</span> email; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEmail</span><span class="params">(String email)</span> &#123; <span class="built_in">this</span>.email = email; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-RequestParam"><a href="#4-RequestParam" class="headerlink" title="4. @RequestParam"></a>4. @RequestParam</h3><p>作用：从URL查询参数或表单数据中提取值。</p>
<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ParamController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 基本使用</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/search&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">search</span><span class="params">(<span class="meta">@RequestParam</span> String keyword)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Searching for: &quot;</span> + keyword;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 指定参数名和默认值</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPage</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(value = &quot;page&quot;, defaultValue = &quot;1&quot;)</span> <span class="type">int</span> page,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(value = &quot;size&quot;, defaultValue = &quot;10&quot;)</span> <span class="type">int</span> size)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;Page: %d, Size: %d&quot;</span>, page, size);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 可选参数</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/optional&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">optionalParam</span><span class="params">(<span class="meta">@RequestParam(required = false)</span> String filter)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> filter != <span class="literal">null</span> ? <span class="string">&quot;Filter: &quot;</span> + filter : <span class="string">&quot;No filter&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取所有参数</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/all-params&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getAllParams</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam</span> Map&lt;String, String&gt; allParams)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> allParams;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 多值参数</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/multi&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getMultiParams</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;String&gt; tags)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tags;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 处理数组参数</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/array&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String[] getArrayParams(<span class="meta">@RequestParam</span> String[] ids) &#123;</span><br><span class="line">        <span class="keyword">return</span> ids;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-MatrixVariable"><a href="#5-MatrixVariable" class="headerlink" title="5. @MatrixVariable"></a>5. @MatrixVariable</h3><p>作用：从URL路径的矩阵变量中提取值（需要额外配置）。</p>
<p>配置和使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configurePathMatch</span><span class="params">(PathMatchConfigurer configurer)</span> &#123;</span><br><span class="line">        <span class="type">UrlPathHelper</span> <span class="variable">urlPathHelper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UrlPathHelper</span>();</span><br><span class="line">        urlPathHelper.setRemoveSemicolonContent(<span class="literal">false</span>);</span><br><span class="line">        configurer.setUrlPathHelper(urlPathHelper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MatrixController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 基本矩阵变量</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/cars/&#123;car&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCar</span><span class="params">(<span class="meta">@PathVariable</span> String car,</span></span><br><span class="line"><span class="params">                        <span class="meta">@MatrixVariable</span> String color,</span></span><br><span class="line"><span class="params">                        <span class="meta">@MatrixVariable</span> String year)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;Car: %s, Color: %s, Year: %s&quot;</span>, car, color, year);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// URL示例: /cars/BMW;color=red;year=2022</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 指定路径变量的矩阵变量</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/owners/&#123;ownerId&#125;/pets/&#123;petId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">findPet</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@MatrixVariable(pathVar = &quot;ownerId&quot;)</span> String q1,</span></span><br><span class="line"><span class="params">            <span class="meta">@MatrixVariable(pathVar = &quot;petId&quot;)</span> String q2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Owner query: &quot;</span> + q1 + <span class="string">&quot;, Pet query: &quot;</span> + q2;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// URL示例: /owners/123;q=ownerQuery/pets/456;q=petQuery</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取所有矩阵变量</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/products/&#123;category&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getMatrixVars</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@MatrixVariable</span> Map&lt;String, String&gt; matrixVars)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> matrixVars;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 多值矩阵变量</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/filter/&#123;criteria&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getMultiMatrix</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@MatrixVariable</span> List&lt;String&gt; filters)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> filters;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-CookieValue"><a href="#6-CookieValue" class="headerlink" title="6. @CookieValue"></a>6. @CookieValue</h3><p>作用：从HTTP Cookie中提取值。</p>
<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取Cookie值</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/cookie&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCookie</span><span class="params">(<span class="meta">@CookieValue(&quot;JSESSIONID&quot;)</span> String sessionId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Session ID: &quot;</span> + sessionId;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置默认值</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/theme&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTheme</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@CookieValue(value = &quot;theme&quot;, defaultValue = &quot;light&quot;)</span> String theme)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Theme: &quot;</span> + theme;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取完整的Cookie对象</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/full-cookie&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFullCookie</span><span class="params">(<span class="meta">@CookieValue(&quot;JSESSIONID&quot;)</span> Cookie sessionCookie)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;Name: %s, Value: %s, Domain: %s&quot;</span>, </span><br><span class="line">                sessionCookie.getName(), </span><br><span class="line">                sessionCookie.getValue(),</span><br><span class="line">                sessionCookie.getDomain());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置Cookie的示例</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/set-cookie&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">setCookie</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ResponseCookie</span> <span class="variable">cookie</span> <span class="operator">=</span> ResponseCookie.from(<span class="string">&quot;user-token&quot;</span>, <span class="string">&quot;abc123&quot;</span>)</span><br><span class="line">                .httpOnly(<span class="literal">true</span>)</span><br><span class="line">                .secure(<span class="literal">true</span>)</span><br><span class="line">                .path(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">                .maxAge(Duration.ofHours(<span class="number">1</span>))</span><br><span class="line">                .build();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok()</span><br><span class="line">                .header(HttpHeaders.SET_COOKIE, cookie.toString())</span><br><span class="line">                .body(<span class="string">&quot;Cookie set&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-RequestBody"><a href="#7-RequestBody" class="headerlink" title="7. @RequestBody"></a>7. @RequestBody</h3><p>作用：将HTTP请求体绑定到方法参数，主要用于处理JSON&#x2F;XML等格式的数据。</p>
<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BodyController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 绑定到简单对象</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        <span class="comment">// 处理用户创建逻辑</span></span><br><span class="line">        <span class="keyword">return</span> userService.save(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 绑定到Map</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/map&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">handleMap</span><span class="params">(<span class="meta">@RequestBody</span> Map&lt;String, Object&gt; payload)</span> &#123;</span><br><span class="line">        payload.put(<span class="string">&quot;processed&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        payload.put(<span class="string">&quot;timestamp&quot;</span>, LocalDateTime.now());</span><br><span class="line">        <span class="keyword">return</span> payload;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 绑定到List</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/batch&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">batchCreate</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;User&gt; users)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Created &quot;</span> + users.size() + <span class="string">&quot; users&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 绑定到字符串</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/raw&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleRawBody</span><span class="params">(<span class="meta">@RequestBody</span> String rawBody)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Received: &quot;</span> + rawBody;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用HttpEntity获取完整请求信息</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/entity&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleEntity</span><span class="params">(HttpEntity&lt;String&gt; entity)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> entity.getBody();</span><br><span class="line">        <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> entity.getHeaders();</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;Body: %s, Content-Type: %s&quot;</span>, </span><br><span class="line">                body, headers.getContentType());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 验证请求体</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/validate&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;?&gt; createValidUser(<span class="meta">@Valid</span> <span class="meta">@RequestBody</span> User user) &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">savedUser</span> <span class="operator">=</span> userService.save(user);</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok(savedUser);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 验证注解示例</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;姓名不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Min(value = 0, message = &quot;年龄不能小于0&quot;)</span></span><br><span class="line">    <span class="meta">@Max(value = 150, message = &quot;年龄不能大于150&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Email(message = &quot;邮箱格式不正确&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// getter和setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-2-复杂参数接收请求数据"><a href="#8-2-复杂参数接收请求数据" class="headerlink" title="8.2 复杂参数接收请求数据"></a>8.2 复杂参数接收请求数据</h2><h3 id="1-常用复杂参数类型"><a href="#1-常用复杂参数类型" class="headerlink" title="1. 常用复杂参数类型"></a>1. 常用复杂参数类型</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonParamsController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 常用复杂参数</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleRequest</span><span class="params">(</span></span><br><span class="line"><span class="params">            Map&lt;String, Object&gt; map,                    // 数据存储</span></span><br><span class="line"><span class="params">            Model model,                                // 模型数据  </span></span><br><span class="line"><span class="params">            RedirectAttributes redirectAttributes,     // 重定向属性</span></span><br><span class="line"><span class="params">            HttpServletResponse response,              // HTTP响应</span></span><br><span class="line"><span class="params">            HttpSession session                        // Session</span></span><br><span class="line"><span class="params">    )</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-Map-和-Model-Request域数据"><a href="#2-Map-和-Model-Request域数据" class="headerlink" title="2. Map 和 Model - Request域数据"></a>2. Map 和 Model - Request域数据</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">(Map&lt;String, Object&gt; map, Model model)</span> &#123;</span><br><span class="line">        <span class="comment">// Map 和 Model 数据都会放在request域中（底层request.setAttribute()）</span></span><br><span class="line">        map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;age&quot;</span>, <span class="number">25</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 在模板中通过 $&#123;name&#125;、$&#123;age&#125; 获取</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 快捷方式 - 直接返回数据</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/data&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; data = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        data.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">        data.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;成功&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-RedirectAttributes-重定向携带数据"><a href="#3-RedirectAttributes-重定向携带数据" class="headerlink" title="3. RedirectAttributes - 重定向携带数据"></a>3. RedirectAttributes - 重定向携带数据</h3><p>java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedirectController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping(&quot;/addUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">addUser</span><span class="params">(User user, RedirectAttributes redirectAttributes)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            userService.save(user);</span><br><span class="line">            <span class="comment">// 添加flash属性 - 重定向后自动消失</span></span><br><span class="line">            redirectAttributes.addFlashAttribute(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;用户添加成功&quot;</span>);</span><br><span class="line">            redirectAttributes.addFlashAttribute(<span class="string">&quot;alertType&quot;</span>, <span class="string">&quot;success&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            redirectAttributes.addFlashAttribute(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">            redirectAttributes.addFlashAttribute(<span class="string">&quot;alertType&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/user/list&quot;</span>;  <span class="comment">// 重定向到列表页</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 普通属性（会拼接到URL）</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/search&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">search</span><span class="params">(String keyword, RedirectAttributes redirectAttributes)</span> &#123;</span><br><span class="line">        redirectAttributes.addAttribute(<span class="string">&quot;keyword&quot;</span>, keyword); <span class="comment">// → /result?keyword=xxx</span></span><br><span class="line">        redirectAttributes.addAttribute(<span class="string">&quot;page&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/result&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-HttpServletResponse-响应控制"><a href="#4-HttpServletResponse-响应控制" class="headerlink" title="4. HttpServletResponse - 响应控制"></a>4. HttpServletResponse - 响应控制</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/download&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">downloadFile</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 设置响应头</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment; filename=file.txt&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 直接写入响应流</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">        os.write(<span class="string">&quot;文件内容&quot;</span>.getBytes());</span><br><span class="line">        os.flush();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/json&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnJson</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">        out.write(<span class="string">&quot;&#123;\&quot;status\&quot;:\&quot;success\&quot;&#125;&quot;</span>);</span><br><span class="line">        out.flush();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-HttpSession-会话管理"><a href="#5-HttpSession-会话管理" class="headerlink" title="5. HttpSession - 会话管理"></a>5. HttpSession - 会话管理</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(User user, HttpSession session)</span> &#123;</span><br><span class="line">        <span class="comment">// 存储用户信息到session</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;currentUser&quot;</span>, user);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;loginTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 设置session超时时间（分钟）</span></span><br><span class="line">        session.setMaxInactiveInterval(<span class="number">30</span> * <span class="number">60</span>); <span class="comment">// 30分钟</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/home&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/profile&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">profile</span><span class="params">(HttpSession session, Model model)</span> &#123;</span><br><span class="line">        <span class="comment">// 从session获取数据</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) session.getAttribute(<span class="string">&quot;currentUser&quot;</span>);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;profile&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/logout&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">logout</span><span class="params">(HttpSession session)</span> &#123;</span><br><span class="line">        <span class="comment">// 销毁session</span></span><br><span class="line">        session.invalidate();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-实际应用示例"><a href="#6-实际应用示例" class="headerlink" title="6. 实际应用示例"></a>6. 实际应用示例</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PracticalExample</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping(&quot;/submitOrder&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">submitOrder</span><span class="params">(Order order, </span></span><br><span class="line"><span class="params">                            HttpSession session,</span></span><br><span class="line"><span class="params">                            RedirectAttributes redirectAttributes)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. 从session获取用户</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) session.getAttribute(<span class="string">&quot;currentUser&quot;</span>);</span><br><span class="line">        order.setUserId(user.getId());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. 业务处理</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            orderService.create(order);</span><br><span class="line">            redirectAttributes.addFlashAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;订单创建成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            redirectAttributes.addFlashAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;创建失败：&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. 重定向到结果页</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/order/result&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/export&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportData</span><span class="params">(String type, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 设置响应</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/vnd.ms-excel&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment; filename=data.xlsx&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 导出逻辑</span></span><br><span class="line">        excelService.export(data, response.getOutputStream());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-3-自定义对象参数自动封装"><a href="#8-3-自定义对象参数自动封装" class="headerlink" title="8.3 自定义对象参数自动封装"></a>8.3 自定义对象参数自动封装</h2><h3 id="1-基本介绍"><a href="#1-基本介绍" class="headerlink" title="1. 基本介绍"></a>1. 基本介绍</h3><ul>
<li><strong>自动封装</strong>：SpringBoot支持将请求参数自动封装到自定义对象</li>
<li><strong>类型转换</strong>：自动完成数据类型转换与格式化</li>
<li><strong>级联封装</strong>：支持对象属性的嵌套封装</li>
</ul>
<h3 id="2-基本使用"><a href="#2-基本使用" class="headerlink" title="2. 基本使用"></a>2. 基本使用</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 用户实体</span></span><br><span class="line"><span class="meta">@Date</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Date birthDate;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Controller 使用</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 自动封装对象参数</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// SpringBoot自动将请求参数封装到User对象</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户: &quot;</span> + user.getName() + <span class="string">&quot;, 年龄: &quot;</span> + user.getAge();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>请求示例</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /user?name=张三&amp;age=25&amp;email=zhangsan@example.com&amp;birthDate=2023-01-01</span><br></pre></td></tr></table></figure>



<h3 id="3-级联封装（嵌套对象）"><a href="#3-级联封装（嵌套对象）" class="headerlink" title="3. 级联封装（嵌套对象）"></a>3. 级联封装（嵌套对象）</h3><p><strong>嵌套对象定义</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 地址类</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String province;</span><br><span class="line">    <span class="keyword">private</span> String city;</span><br><span class="line">    <span class="keyword">private</span> String street;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户类（包含地址）</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Address address;  <span class="comment">// 嵌套对象</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>级联封装使用</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping(&quot;/userWithAddress&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createUserWithAddress</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// 自动级联封装</span></span><br><span class="line">        <span class="keyword">return</span> user.getName() + <span class="string">&quot; 住在 &quot;</span> + user.getAddress().getCity();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>请求示例</strong>：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/userWithAddress?</span></span><br><span class="line"><span class="attr">name</span>=<span class="string">李四&amp;</span></span><br><span class="line"><span class="attr">age</span>=<span class="string">30&amp;</span></span><br><span class="line"><span class="attr">address.province</span>=<span class="string">广东&amp;</span></span><br><span class="line"><span class="attr">address.city</span>=<span class="string">深圳&amp;</span></span><br><span class="line"><span class="attr">address.street</span>=<span class="string">科技园</span></span><br></pre></td></tr></table></figure>



<h3 id="4-列表和数组封装"><a href="#4-列表和数组封装" class="headerlink" title="4. 列表和数组封装"></a>4. 列表和数组封装</h3><p><strong>支持集合类型</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Date</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbies;     <span class="comment">// 列表</span></span><br><span class="line">    <span class="keyword">private</span> String[] skills;          <span class="comment">// 数组</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/userWithList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">userWithList</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> user.getName() + <span class="string">&quot; 有 &quot;</span> + user.getHobbies().size() + <span class="string">&quot; 个爱好&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>请求示例</strong>：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/userWithList?</span></span><br><span class="line"><span class="attr">name</span>=<span class="string">王五&amp;</span></span><br><span class="line"><span class="attr">hobbies</span>=<span class="string">读书&amp;</span></span><br><span class="line"><span class="attr">hobbies</span>=<span class="string">游泳&amp;</span></span><br><span class="line"><span class="attr">hobbies</span>=<span class="string">编程&amp;</span></span><br><span class="line"><span class="attr">skills</span>=<span class="string">Java&amp;</span></span><br><span class="line"><span class="attr">skills</span>=<span class="string">Spring</span></span><br></pre></td></tr></table></figure>



<h3 id="5-实际应用示例"><a href="#5-实际应用示例" class="headerlink" title="5. 实际应用示例"></a>5. 实际应用示例</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 订单相关实体</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String orderNo;</span><br><span class="line">    <span class="keyword">private</span> BigDecimal amount;</span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderItem&gt; items;  <span class="comment">// 订单项列表</span></span><br><span class="line">    <span class="keyword">private</span> User user;              <span class="comment">// 用户信息</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderItem</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String productName;</span><br><span class="line">    <span class="keyword">private</span> Integer quantity;</span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping(&quot;/createOrder&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createOrder</span><span class="params">(Order order)</span> &#123;</span><br><span class="line">        <span class="comment">// 自动封装复杂对象结构</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;订单创建成功: &quot;</span> + order.getOrderNo() + </span><br><span class="line">               <span class="string">&quot;, 金额: &quot;</span> + order.getAmount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>请求示例</strong>：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/createOrder?</span></span><br><span class="line"><span class="attr">orderNo</span>=<span class="string">ORD001&amp;</span></span><br><span class="line"><span class="attr">amount</span>=<span class="string">299.99&amp;</span></span><br><span class="line"><span class="attr">user.name</span>=<span class="string">张三&amp;</span></span><br><span class="line"><span class="attr">items[0].productName</span>=<span class="string">手机&amp;</span></span><br><span class="line"><span class="attr">items[0].quantity</span>=<span class="string">1&amp;</span></span><br><span class="line"><span class="attr">items[0].price</span>=<span class="string">2999&amp;</span></span><br><span class="line"><span class="attr">items[1].productName</span>=<span class="string">耳机&amp;</span></span><br><span class="line"><span class="attr">items[1].quantity</span>=<span class="string">2&amp;</span></span><br><span class="line"><span class="attr">items[1].price</span>=<span class="string">199</span></span><br></pre></td></tr></table></figure>

<h1 id="9-自定义转换器"><a href="#9-自定义转换器" class="headerlink" title="9 自定义转换器"></a>9 自定义转换器</h1><h2 id="1-基本介绍-1"><a href="#1-基本介绍-1" class="headerlink" title="1. 基本介绍"></a>1. 基本介绍</h2><p><strong>核心概念</strong></p>
<ul>
<li><strong>内置转换器</strong>：SpringBoot 使用内置转换器将请求数据封装成对象</li>
<li><strong>自定义转换器</strong>：支持开发自定义转换器处理特殊数据类型</li>
<li><strong>调试查看</strong>：在 debug 时可以看到内置转换器的工作过程</li>
</ul>
<h2 id="2-内置转换器示例"><a href="#2-内置转换器示例" class="headerlink" title="2. 内置转换器示例"></a>2. 内置转换器示例</h2><p><strong>自动类型转换</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// SpringBoot 内置转换器自动处理类型转换</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">(</span></span><br><span class="line"><span class="params">        Integer id,           // String → Integer</span></span><br><span class="line"><span class="params">        Boolean status,       // String → Boolean  </span></span><br><span class="line"><span class="params">        Date createTime,      // String → Date</span></span><br><span class="line"><span class="params">        BigDecimal amount     // String → BigDecimal</span></span><br><span class="line"><span class="params">    )</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ID: &quot;</span> + id + <span class="string">&quot;, Status: &quot;</span> + status;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>请求示例</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /test?id=123&amp;status=true&amp;createTime=2023-01-01&amp;amount=99.99</span><br></pre></td></tr></table></figure>



<h2 id="3-自定义转换器场景"><a href="#3-自定义转换器场景" class="headerlink" title="3. 自定义转换器场景"></a>3. 自定义转换器场景</h2><p><strong>需要自定义的情况</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 场景1：特殊格式字符串转换</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; tags;  <span class="comment">// 需要将 &quot;java,spring,boot&quot; 转换为 List</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景2：自定义对象转换  </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Coordinate</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Double x;</span><br><span class="line">    <span class="keyword">private</span> Double y;</span><br><span class="line">    <span class="comment">// 需要将 &quot;10.5,20.3&quot; 转换为 Coordinate 对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-实现自定义转换器"><a href="#4-实现自定义转换器" class="headerlink" title="4. 实现自定义转换器"></a>4. 实现自定义转换器</h2><h4 id="方式1：Converter-接口"><a href="#方式1：Converter-接口" class="headerlink" title="方式1：Converter 接口"></a><strong>方式1：Converter 接口</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串到List的转换器</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToListConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String, List&lt;String&gt;&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">convert</span><span class="params">(String source)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (source == <span class="literal">null</span> || source.trim().isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 将 &quot;java,spring,boot&quot; 转换为 List</span></span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(source.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">                    .map(String::trim)</span><br><span class="line">                    .collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串到坐标对象的转换器</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToCoordinateConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String, Coordinate&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Coordinate <span class="title function_">convert</span><span class="params">(String source)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (source == <span class="literal">null</span> || !source.contains(<span class="string">&quot;,&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String[] parts = source.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="type">Coordinate</span> <span class="variable">coord</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Coordinate</span>();</span><br><span class="line">        coord.setX(Double.parseDouble(parts[<span class="number">0</span>].trim()));</span><br><span class="line">        coord.setY(Double.parseDouble(parts[<span class="number">1</span>].trim()));</span><br><span class="line">        <span class="keyword">return</span> coord;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="方式2：使用配置类注册"><a href="#方式2：使用配置类注册" class="headerlink" title="方式2：使用配置类注册"></a>方式2：使用配置类注册</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFormatters</span><span class="params">(FormatterRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">// 注册自定义转换器</span></span><br><span class="line">        registry.addConverter(<span class="keyword">new</span> <span class="title class_">StringToListConverter</span>());</span><br><span class="line">        registry.addConverter(<span class="keyword">new</span> <span class="title class_">StringToCoordinateConverter</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-使用自定义转换器"><a href="#5-使用自定义转换器" class="headerlink" title="5. 使用自定义转换器"></a>5. 使用自定义转换器</h2><p><strong>在Controller中使用</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomConverterController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用自定义转换器</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// SpringBoot会自动使用 StringToListConverter</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户: &quot;</span> + user.getName() + <span class="string">&quot;, 标签: &quot;</span> + user.getTags();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/point&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPoint</span><span class="params">(Coordinate coord)</span> &#123;</span><br><span class="line">        <span class="comment">// 自动使用 StringToCoordinateConverter</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;坐标: (&quot;</span> + coord.getX() + <span class="string">&quot;, &quot;</span> + coord.getY() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>实体类定义</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; tags;  <span class="comment">// 自动转换 &quot;java,spring&quot; → List</span></span><br><span class="line">    <span class="keyword">private</span> Coordinate location; <span class="comment">// 自动转换 &quot;10.5,20.3&quot; → Coordinate</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>请求示例</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /user?</span><br><span class="line">name=张三&amp;</span><br><span class="line">tags=java,spring,boot&amp;</span><br><span class="line">location=116.40,39.90</span><br></pre></td></tr></table></figure>



<h2 id="6-调试查看转换器"><a href="#6-调试查看转换器" class="headerlink" title="6. 调试查看转换器"></a>6. 调试查看转换器</h2><p><strong>调试方法</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DebugController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping(&quot;/debug&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">debug</span><span class="params">(<span class="meta">@RequestParam</span> String data, WebDataBinder binder)</span> &#123;</span><br><span class="line">        <span class="comment">// 在debug时可以查看binder中的转换服务</span></span><br><span class="line">        <span class="comment">// 查看 ConversionService 中的注册的转换器</span></span><br><span class="line">        System.out.println(<span class="string">&quot;转换器数量: &quot;</span> + binder.getConversionService());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;调试信息&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="10-拦截器-HandlerInterceptor"><a href="#10-拦截器-HandlerInterceptor" class="headerlink" title="10 拦截器-HandlerInterceptor"></a>10 拦截器-HandlerInterceptor</h1><h2 id="10-1-基本介绍"><a href="#10-1-基本介绍" class="headerlink" title="10.1 基本介绍"></a>10.1 基本介绍</h2><p>在 Spring Boot 项目中， 拦截器是开发中常用手段，要来做登陆验证、性能检查、日志记录等。</p>
<h2 id="10-2-拦截器应用实例"><a href="#10-2-拦截器应用实例" class="headerlink" title="10.2 拦截器应用实例"></a>10.2 拦截器应用实例</h2><p>需求: 使用拦截器防止用户非法登录, 使用拦截器就不需要在每个方法验证了</p>
<p>浏览器输入 : <a target="_blank" rel="noopener" href="http://localhost:8080/manage.html">http://localhost:8080/manage.html</a> , 如果用户没有登录，则返回登录界面.</p>
<p>代码实现：</p>
<p>创建 com&#x2F;wzb&#x2F;usersys&#x2F;interceptor&#x2F;LoginInterceptor.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">* 目标方法执行之前*/</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        log.info(<span class="string">&quot;preHandle 拦截的请求路径是&#123;&#125;&quot;</span>, requestURI);</span><br><span class="line">        <span class="comment">//登录检查逻辑</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">loginAdmin</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;loginAdmin&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (loginAdmin != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">//放行</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//拦截</span></span><br><span class="line">        request.setAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;错误/重新登录&quot;</span>);</span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/&quot;</span>).forward(request, response);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">* 目标方法执行完成以后*/</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        log.info(<span class="string">&quot;postHandle 执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">* 页面渲染以后*/</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">                                Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        log.info(<span class="string">&quot;afterCompletion 执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建 com&#x2F;wzb&#x2F;usersys&#x2F;config&#x2F;WebConfig.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 这里实现 Spring-Boot 定制功能, 加入自己的配置</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>())</span><br><span class="line">            .addPathPatterns(<span class="string">&quot;/**&quot;</span>) <span class="comment">//拦截所有请求</span></span><br><span class="line">            .excludePathPatterns(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;/login&quot;</span>, <span class="string">&quot;/images/**&quot;</span>); <span class="comment">//放行的请求, 可以根据需要增加&#125;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>注册拦截器, 依然可以使用如下方式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="comment">/*implements WebMvcConfigurer*/</span> &#123;</span><br><span class="line">    <span class="comment">//将我们的拦截器, 注入到容器中</span></span><br><span class="line">    <span class="comment">//@Override</span></span><br><span class="line">    <span class="comment">//public void addInterceptors(InterceptorRegistry registry) &#123;</span></span><br><span class="line">    <span class="comment">// System.out.println(&quot;addInterceptors...&quot;);</span></span><br><span class="line">    <span class="comment">// //加入我们的拦截器</span></span><br><span class="line">    <span class="comment">// registry.addInterceptor(new LoginInterceptor())</span></span><br><span class="line">    <span class="comment">// .addPathPatterns(&quot;/**&quot;) //拦截所有请求</span></span><br><span class="line">    <span class="comment">// .excludePathPatterns(&quot;/&quot;,&quot;/login&quot;,&quot;/images/**&quot;);//</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> WebMvcConfigurer <span class="title function_">webMvcConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WebMvcConfigurer</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;addInterceptors...~~~~:):)&quot;</span>);</span><br><span class="line">                <span class="comment">//加入我们的拦截器</span></span><br><span class="line">                registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>())</span><br><span class="line">                    .addPathPatterns(<span class="string">&quot;/**&quot;</span>) <span class="comment">//拦截所有请求.excludePathPatterns(&quot;/&quot;, &quot;/login&quot;, &quot;/images/**&quot;);//</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="11-文件上传"><a href="#11-文件上传" class="headerlink" title="11 文件上传"></a>11 文件上传</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;#&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/upload&#125;&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span>用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    电 邮:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    年 龄:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    职 位:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px&quot;</span> <span class="attr">name</span>=<span class="string">&quot;job&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    头 像:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px&quot;</span> <span class="attr">name</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    宠 物:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px&quot;</span> <span class="attr">name</span>=<span class="string">&quot;photos&quot;</span> <span class="attr">multiple</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;注册&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;重新填写&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>进行文件上传时要将enctype&#x3D;”multipart&#x2F;form-data”写成这样</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UploadController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/upload.html&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">uploadPage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;upload&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">* MultipartFile 自动封装上传过来的文件</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(<span class="meta">@RequestParam(&quot;email&quot;)</span> String email, <span class="meta">@RequestParam(&quot;name&quot;)</span>String name, <span class="meta">@RequestParam(&quot;age&quot;)</span> Integer age, <span class="meta">@RequestParam(&quot;job&quot;)</span></span></span><br><span class="line"><span class="params">                         String job, <span class="meta">@RequestPart(&quot;header&quot;)</span> MultipartFile header, <span class="meta">@RequestPart(&quot;photos&quot;)</span> MultipartFile[] photos)</span> throwsIOException &#123;</span><br><span class="line">        log.info(<span class="string">&quot;上传的信息：email=&#123;&#125;，name=&#123;&#125;，age=&#123;&#125;, job=&#123;&#125;, header=&#123;&#125;，photos=&#123;&#125;&quot;</span>, email, name, age, job, header.getSize(), photos.length);</span><br><span class="line">        <span class="comment">// 也 可 以 自 己 动 态 的 创 建 上 传 文 件 目 录 , 来存放文件, 比如在resources/static/images/upload/</span></span><br><span class="line">        <span class="comment">// String path = ResourceUtils.getURL(&quot;classpath:&quot;).getPath();</span></span><br><span class="line">        <span class="comment">// File file = new File(path + &quot;static/images/upload/&quot;);</span></span><br><span class="line">        <span class="comment">// if (!file.exists()) file.mkdirs();</span></span><br><span class="line">        <span class="keyword">if</span> (!header.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">//保存到文件服务器或者 OSS 服务器//需要先创建好d:\\temp_upload 目录String originalFilename = header.getOriginalFilename();</span></span><br><span class="line">            <span class="comment">//方式 1: 指定某个目录存放上传文件</span></span><br><span class="line">            header.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;d:\\temp_upload\\&quot;</span> + originalFilename));</span><br><span class="line">            <span class="comment">//方式 2: 动态的创建文件存放文件</span></span><br><span class="line">            <span class="comment">//header.transferTo(new File(file.getAbsolutePath() + &quot;/&quot; + originalFilename));</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (photos.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (MultipartFile photo : photos) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!photo.isEmpty()) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> photo.getOriginalFilename();</span><br><span class="line">                    photo.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;d:\\temp_upload\\&quot;</span> + originalFilename));</span><br><span class="line">                    <span class="comment">//photo.transferTo(new File(file.getAbsolutePath() + &quot;/&quot; +originalFilename));</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;上传成功~~&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改 WebConfig 配置，放行&#x2F;upload.html 和 &#x2F;upload 请求</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>())</span><br><span class="line">            .addPathPatterns(<span class="string">&quot;/**&quot;</span>) <span class="comment">//拦截所有请求</span></span><br><span class="line">            .excludePathPatterns(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;/login&quot;</span>, <span class="string">&quot;/images/**&quot;</span>, <span class="string">&quot;/upload.html&quot;</span>, <span class="string">&quot;/upload&quot;</span>); <span class="comment">//放行的请求, 可以根据需要增加&#125;</span></span><br></pre></td></tr></table></figure>

<p>在配置文件中修改文件上传配置参数，max-file-size 单个文件大小, max-request-size 一次请求最大上传大小(多个文件.)</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="attr">max-file-size:</span> <span class="string">5MB</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">50MB</span></span><br></pre></td></tr></table></figure>

<h1 id="12-异常处理"><a href="#12-异常处理" class="headerlink" title="12 异常处理"></a>12 异常处理</h1><h2 id="12-1-基本介绍"><a href="#12-1-基本介绍" class="headerlink" title="12.1 基本介绍"></a>12.1 基本介绍</h2><p>默认情况下，Spring Boot 提供&#x2F;error 处理所有错误的映射</p>
<p>对于机器客户端，它将生成 JSON 响应，其中包含错误，HTTP 状态和异常消息的详细信息。对于浏览器客户端，响应一个”whitelabel”错误视图，以HTML 格式呈现相同的数据</p>
<p><img src="springboot%E5%AD%A6%E4%B9%A0%5C12.jpg"></p>
<h2 id="12-2-拦截器VS过滤器"><a href="#12-2-拦截器VS过滤器" class="headerlink" title="12.2 拦截器VS过滤器"></a>12.2 拦截器VS过滤器</h2><p>使用范围不同：</p>
<ul>
<li>过滤器 实现的是 javax.servlet.Filter 接口，而这个接口是在Servlet 规范中定义的，也就是说过滤器 Filter 的使用要依赖于 Tomcat 等容器，Filter 只能在web 程序中使用</li>
<li>拦截器(Interceptor) 它是一个 Spring 组件，并由 Spring 容器管理，并不依赖Tomcat 等容器，是可以单独使用的。不仅能应用在 web 程序中，也可以用于Application 等程序中</li>
</ul>
<p>过滤器 和 拦截器的触发时机也不同，看下边这张图</p>
<p><img src="springboot%E5%AD%A6%E4%B9%A0%5C13.jpg"></p>
<ul>
<li>过滤器 Filter 是在请求进入容器后, 但在进入 servlet 之前进行预处理, 请求结束是在servlet 处理完以后 </li>
<li>拦截器 Interceptor 是在请求进入 servlet 后, 在进入 Controller 之前进行预处理的, Controller 中渲染了对应的视图之后请求结束</li>
</ul>
<p><strong>过滤器不会处理请求转发, 拦截器会处理请求转发</strong>，这里举例说明：</p>
<p><strong>场景设定</strong></p>
<p>假设我们有一个请求：</p>
<ol>
<li>用户访问 <code>/start</code>。</li>
<li>Controller 处理 <code>/start</code>，然后<strong>转发</strong>到 <code>/forward</code>。</li>
<li>Controller 处理 <code>/forward</code>，返回结果。</li>
</ol>
<p>我们将创建一个<strong>过滤器</strong>和一个<strong>拦截器</strong>，并观察它们在这个流程中的行为。</p>
<hr>
<ol>
<li><strong>创建过滤器 (Filter)</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span> <span class="comment">// 过滤所有请求</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        System.out.println(<span class="string">&quot;过滤器 Filter: 进入 &quot;</span> + req.getRequestURI() + <span class="string">&quot; | 请求类型: &quot;</span> + getDispatcherType(req));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行后续过滤器或Servlet</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;过滤器 Filter: 退出 &quot;</span> + req.getRequestURI());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getDispatcherType</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// 获取请求的派发类型</span></span><br><span class="line">        <span class="keyword">return</span> request.getDispatcherType().toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="2">
<li><strong>创建拦截器 (Interceptor)</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;拦截器 Interceptor: preHandle  &quot;</span> + request.getRequestURI() + <span class="string">&quot; | 请求类型: &quot;</span> + request.getDispatcherType());</span><br><span class="line">        <span class="comment">// 在Controller方法执行前调用</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 继续流程</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;拦截器 Interceptor: postHandle &quot;</span> + request.getRequestURI() + <span class="string">&quot; | 请求类型: &quot;</span> + request.getDispatcherType());</span><br><span class="line">        <span class="comment">// 在Controller方法执行后，视图渲染前调用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;拦截器 Interceptor: afterCompletion &quot;</span> + request.getRequestURI() + <span class="string">&quot; | 请求类型: &quot;</span> + request.getDispatcherType());</span><br><span class="line">        <span class="comment">// 在整个请求完成后调用</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>通过配置类注册这个拦截器：</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MyInterceptor myInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(myInterceptor)</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>); <span class="comment">// 拦截所有路径</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="3">
<li><strong>创建控制器 (Controller)</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/start&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--- Controller: 处理 /start，准备转发到 /forward ---&quot;</span>);</span><br><span class="line">        <span class="comment">// 关键：这里是服务器端转发</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;forward:/forward&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/forward&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">forward</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--- Controller: 处理 /forward ---&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>; <span class="comment">// 返回一个视图名</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<ol start="4">
<li><strong>运行并访问 <code>/start</code> 查看控制台输出</strong></li>
</ol>
<p>当你访问 <code>http://localhost:8080/start</code> 时，控制台的输出顺序和内容将非常说明问题：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 原始请求 /start 进入</span></span><br><span class="line">过滤器 Filter: 进入 /start | 请求类型: REQUEST</span><br><span class="line">拦截器 Interceptor: preHandle  /start | 请求类型: REQUEST</span><br><span class="line"></span><br><span class="line">--- Controller: 处理 /start，准备转发到 /forward ---</span><br><span class="line"></span><br><span class="line">拦截器 Interceptor: postHandle /start | 请求类型: REQUEST</span><br><span class="line">拦截器 Interceptor: afterCompletion /start | 请求类型: REQUEST</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 注意！过滤器没有为转发的请求再次执行！</span></span><br><span class="line"><span class="comment">// 但拦截器处理了！</span></span><br><span class="line">拦截器 Interceptor: preHandle  /forward | 请求类型: FORWARD</span><br><span class="line"></span><br><span class="line">--- Controller: 处理 /forward ---</span><br><span class="line"></span><br><span class="line">拦截器 Interceptor: postHandle /forward | 请求类型: FORWARD</span><br><span class="line">拦截器 Interceptor: afterCompletion /forward | 请求类型: FORWARD</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 最终，原始请求的过滤器退出</span></span><br><span class="line">过滤器 Filter: 退出 /start</span><br></pre></td></tr></table></figure>



<p><strong>关键分析</strong></p>
<p>从输出结果可以清晰地看到：</p>
<ol>
<li><strong>过滤器 (Filter)</strong>：<ul>
<li>只记录了 <strong><code>进入 /start</code></strong> 和 <strong><code>退出 /start</code></strong>。</li>
<li>对于从 <code>/start</code> 转发到 <code>/forward</code> 的这次<strong>内部请求，过滤器完全忽略了</strong>。它只处理了一次 <code>DispatcherType.REQUEST</code>。</li>
</ul>
</li>
<li><strong>拦截器 (Interceptor)</strong>：<ul>
<li>处理了两次请求：<ul>
<li>第一次：<code>/start</code>，请求类型为 <strong><code>REQUEST</code></strong>。</li>
<li>第二次：<code>/forward</code>，请求类型为 <strong><code>FORWARD</code></strong>。</li>
</ul>
</li>
<li>它完整地参与了Spring MVC的整个内部流程，包括请求转发。</li>
</ul>
</li>
</ol>
<p><strong>如何让过滤器也处理转发？</strong></p>
<p>如果你需要让过滤器也能处理转发请求，可以在注册过滤器时进行配置。在Spring Boot中，使用 <code>FilterRegistrationBean</code>：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean&lt;MyFilter&gt; <span class="title function_">myFilterRegistration</span><span class="params">()</span> &#123;</span><br><span class="line">        FilterRegistrationBean&lt;MyFilter&gt; registration = <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;();</span><br><span class="line">        registration.setFilter(<span class="keyword">new</span> <span class="title class_">MyFilter</span>());</span><br><span class="line">        registration.addUrlPatterns(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">        <span class="comment">// 设置派发类型，使其也处理转发</span></span><br><span class="line">        registration.setDispatcherTypes(DispatcherType.REQUEST, DispatcherType.FORWARD);</span><br><span class="line">        <span class="keyword">return</span> registration;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这样配置后，过滤器也会对 <code>FORWARD</code> 类型的请求生效。</p>
<h2 id="12-3-自定义异常页面"><a href="#12-3-自定义异常页面" class="headerlink" title="12.3 自定义异常页面"></a>12.3 自定义异常页面</h2><p><strong>核心概念</strong><br>当应用程序抛出异常时，Spring Boot 默认会提供一个名为 “whitelabel error page” 的错误页面。要替换它，我们需要处理 &#x2F;error 路径。Spring Boot 自动将异常信息绑定到请求中，供错误页面使用。</p>
<h3 id="方法一：静态自定义错误页面（最简单）"><a href="#方法一：静态自定义错误页面（最简单）" class="headerlink" title="方法一：静态自定义错误页面（最简单）"></a>方法一：静态自定义错误页面（最简单）</h3><p>这种方式通过创建静态 HTML 页面来定义错误页面，适用于简单的、静态的错误提示。</p>
<p>在 src&#x2F;main&#x2F;resources&#x2F;static&#x2F;error&#x2F; 目录下创建对应的错误状态码 HTML 文件。</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">src/main/resources/</span></span><br><span class="line"><span class="attr">└──</span> <span class="string">static/</span></span><br><span class="line">    <span class="attr">└──</span> <span class="string">error/</span></span><br><span class="line">        <span class="attr">├──</span> <span class="string">404.html</span></span><br><span class="line">        <span class="attr">├──</span> <span class="string">500.html</span></span><br><span class="line">        <span class="attr">└──</span> <span class="string">5xx.html  # 通配符，匹配所有5xx错误</span></span><br></pre></td></tr></table></figure>

<h3 id="方法二：动态模板错误页面（推荐）"><a href="#方法二：动态模板错误页面（推荐）" class="headerlink" title="方法二：动态模板错误页面（推荐）"></a>方法二：动态模板错误页面（推荐）</h3><p>使用模板引擎（Thymeleaf、FreeMarker等）创建动态错误页面，可以显示异常信息。</p>
<p>使用 Thymeleaf 示例<br>在 src&#x2F;main&#x2F;resources&#x2F;templates&#x2F;error&#x2F; 目录下创建模板文件：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">src/main/resources/</span></span><br><span class="line"><span class="attr">└──</span> <span class="string">templates/</span></span><br><span class="line">    <span class="attr">└──</span> <span class="string">error/</span></span><br><span class="line">        <span class="attr">├──</span> <span class="string">404.html</span></span><br><span class="line">        <span class="attr">├──</span> <span class="string">500.html</span></span><br><span class="line">        <span class="attr">└──</span> <span class="string">error.html  # 通用错误页面</span></span><br></pre></td></tr></table></figure>

<h3 id="方法三：使用-ControllerAdvice-全局异常处理（最灵活）"><a href="#方法三：使用-ControllerAdvice-全局异常处理（最灵活）" class="headerlink" title="方法三：使用 @ControllerAdvice 全局异常处理（最灵活）"></a>方法三：使用 @ControllerAdvice 全局异常处理（最灵活）</h3><p>这种方式可以完全控制异常处理逻辑，适合复杂的业务场景。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.NoHandlerFoundException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理404异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(NoHandlerFoundException.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.NOT_FOUND)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleNotFound</span><span class="params">(HttpServletRequest request, Exception ex, Model model)</span> &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;页面不存在&quot;</span>);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;path&quot;</span>, request.getRequestURL());</span><br><span class="line">        model.addAttribute(<span class="string">&quot;timestamp&quot;</span>, java.time.LocalDateTime.now());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error/404&quot;</span>; <span class="comment">// 返回自定义的404页面</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理所有其他异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleAllExceptions</span><span class="params">(HttpServletRequest request, Exception ex, Model model)</span> &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;服务器内部错误&quot;</span>);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;message&quot;</span>, ex.getMessage());</span><br><span class="line">        model.addAttribute(<span class="string">&quot;path&quot;</span>, request.getRequestURL());</span><br><span class="line">        model.addAttribute(<span class="string">&quot;timestamp&quot;</span>, java.time.LocalDateTime.now());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 开发环境显示详细错误</span></span><br><span class="line">        <span class="keyword">if</span> (isDevEnvironment()) &#123;</span><br><span class="line">            model.addAttribute(<span class="string">&quot;exception&quot;</span>, ex.getClass().getName());</span><br><span class="line">            model.addAttribute(<span class="string">&quot;trace&quot;</span>, getStackTrace(ex));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error/500&quot;</span>; <span class="comment">// 返回自定义的500页面</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isDevEnvironment</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 这里可以检查当前环境是否是开发环境</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 实际应用中应该从配置中读取</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getStackTrace</span><span class="params">(Exception ex)</span> &#123;</span><br><span class="line">        java.io.<span class="type">StringWriter</span> <span class="variable">sw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.StringWriter();</span><br><span class="line">        java.io.<span class="type">PrintWriter</span> <span class="variable">pw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.PrintWriter(sw);</span><br><span class="line">        ex.printStackTrace(pw);</span><br><span class="line">        <span class="keyword">return</span> sw.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>为了让404异常能被捕获，需要在 <code>application.properties</code> 中配置：</strong></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启用抛出NoHandlerFoundException而不是返回404页面</span></span><br><span class="line"><span class="attr">spring.mvc.throw-exception-if-no-handler-found</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># 禁止静态资源映射，确保能抛出异常</span></span><br><span class="line"><span class="attr">spring.web.resources.add-mappings</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>



<hr>
<h3 id="方法四：自定义-ErrorController（完全控制）"><a href="#方法四：自定义-ErrorController（完全控制）" class="headerlink" title="方法四：自定义 ErrorController（完全控制）"></a>方法四：自定义 ErrorController（完全控制）</h3><p>实现自定义的 <code>ErrorController</code> 来完全控制错误处理流程。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.error.ErrorController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyCustomErrorController</span> <span class="keyword">implements</span> <span class="title class_">ErrorController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/error&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleError</span><span class="params">(HttpServletRequest request, Model model)</span> &#123;</span><br><span class="line">        <span class="comment">// 从请求中获取错误信息</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">statusCode</span> <span class="operator">=</span> (Integer) request.getAttribute(<span class="string">&quot;javax.servlet.error.status_code&quot;</span>);</span><br><span class="line">        <span class="type">Exception</span> <span class="variable">exception</span> <span class="operator">=</span> (Exception) request.getAttribute(<span class="string">&quot;javax.servlet.error.exception&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestUri</span> <span class="operator">=</span> (String) request.getAttribute(<span class="string">&quot;javax.servlet.error.request_uri&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (requestUri == <span class="literal">null</span>) &#123;</span><br><span class="line">            requestUri = <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        model.addAttribute(<span class="string">&quot;statusCode&quot;</span>, statusCode);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;requestUri&quot;</span>, requestUri);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;exception&quot;</span>, exception);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;timestamp&quot;</span>, java.time.LocalDateTime.now());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 根据状态码返回不同的页面</span></span><br><span class="line">        <span class="keyword">if</span> (statusCode == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;error/404&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (statusCode == <span class="number">500</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;error/500&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;error/error&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个方法是过时的，但在新版本中仍然需要实现</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getErrorPath</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="13-注入-Servlet、Filter、Listener"><a href="#13-注入-Servlet、Filter、Listener" class="headerlink" title="13 注入 Servlet、Filter、Listener"></a>13 注入 Servlet、Filter、Listener</h1><h2 id="13-1-使用-Spring-Boot-注解（最推荐）"><a href="#13-1-使用-Spring-Boot-注解（最推荐）" class="headerlink" title="13.1 使用 Spring Boot 注解（最推荐）"></a>13.1 使用 Spring Boot 注解（最推荐）</h2><p>这是 Spring Boot 中最简单、最常用的方式。</p>
<h3 id="1-注入-Servlet"><a href="#1-注入-Servlet" class="headerlink" title="1. 注入 Servlet"></a>1. 注入 Servlet</h3><p><strong>注意注入的原生 Servlet 不会被 Spring-Boot 拦截器拦截</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/custom-servlet&quot;)</span>  <span class="comment">// 指定Servlet的访问路径</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;&lt;h1&gt;这是自定义Servlet&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;&lt;p&gt;当前时间: &quot;</span> + <span class="keyword">new</span> <span class="title class_">java</span>.util.Date() + <span class="string">&quot;&lt;/p&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-注入-Filter"><a href="#2-注入-Filter" class="headerlink" title="2. 注入 Filter"></a>2. 注入 Filter</h3><p><strong>过滤器配置的 urlPatterns 也会经过 Spring-Boot 拦截器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span>  <span class="comment">// 过滤所有请求</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;自定义过滤器初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, </span></span><br><span class="line"><span class="params">                        FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;过滤器: 请求 &quot;</span> + req.getRequestURI());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 继续执行过滤器链</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">        </span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;过滤器: 响应 &quot;</span> + req.getRequestURI() + <span class="string">&quot; 耗时: &quot;</span> + (endTime - startTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;自定义过滤器销毁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-注入-Listener"><a href="#3-注入-Listener" class="headerlink" title="3. 注入 Listener"></a>3. 注入 Listener</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebListener;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=== 应用程序启动 ===&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletContext 初始化完成&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 可以在这里进行应用启动时的初始化工作</span></span><br><span class="line">        sce.getServletContext().setAttribute(<span class="string">&quot;appStartTime&quot;</span>, System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=== 应用程序关闭 ===&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Long</span> <span class="variable">startTime</span> <span class="operator">=</span> (Long) sce.getServletContext().getAttribute(<span class="string">&quot;appStartTime&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (startTime != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">runTime</span> <span class="operator">=</span> System.currentTimeMillis() - startTime;</span><br><span class="line">            System.out.println(<span class="string">&quot;应用运行时间: &quot;</span> + runTime + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-启用注解扫描"><a href="#4-启用注解扫描" class="headerlink" title="4. 启用注解扫描"></a>4. 启用注解扫描</h3><p><strong>关键步骤</strong>：在 Spring Boot 主类上添加 <code>@ServletComponentScan</code> 注解：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line">import org.springframework.boot.web.servlet.ServletComponentScan;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">@ServletComponentScan  // 扫描 @WebServlet, @WebFilter, @WebListener 注解</span><br><span class="line">public class Application &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="13-2-使用-Java-Config-配置（灵活配置）"><a href="#13-2-使用-Java-Config-配置（灵活配置）" class="headerlink" title="13.2 使用 Java Config 配置（灵活配置）"></a>13.2 使用 Java Config 配置（灵活配置）</h2><p>这种方式更适合需要动态配置的场景。</p>
<h3 id="1-先创建-Servlet、Filter、Listener-类"><a href="#1-先创建-Servlet、Filter、Listener-类" class="headerlink" title="1. 先创建 Servlet、Filter、Listener 类"></a>1. 先创建 Servlet、Filter、Listener 类</h3><p><strong>CustomServlet.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;Java Config 配置的 Servlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>CustomFilter.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, </span></span><br><span class="line"><span class="params">                        FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Java Config Filter 执行前&quot;</span>);</span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">        System.out.println(<span class="string">&quot;Java Config Filter 执行后&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>CustomListener.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Java Config Listener: 应用启动&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Java Config Listener: 应用关闭&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-使用配置类注册"><a href="#2-使用配置类注册" class="headerlink" title="2. 使用配置类注册"></a>2. 使用配置类注册</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletListenerRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注册 Servlet</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletRegistrationBean&lt;CustomServlet&gt; <span class="title function_">customServlet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>&lt;&gt;(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CustomServlet</span>(), </span><br><span class="line">            <span class="string">&quot;/java-config-servlet&quot;</span>  <span class="comment">// 映射路径</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注册 Filter</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean&lt;CustomFilter&gt; <span class="title function_">customFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        FilterRegistrationBean&lt;CustomFilter&gt; registrationBean = </span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;();</span><br><span class="line">        registrationBean.setFilter(<span class="keyword">new</span> <span class="title class_">CustomFilter</span>());</span><br><span class="line">        registrationBean.addUrlPatterns(<span class="string">&quot;/*&quot;</span>);  <span class="comment">// 过滤所有请求</span></span><br><span class="line">        registrationBean.setOrder(<span class="number">1</span>);  <span class="comment">// 设置过滤器执行顺序</span></span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注册 Listener</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletListenerRegistrationBean&lt;CustomListener&gt; <span class="title function_">customListener</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServletListenerRegistrationBean</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">CustomListener</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="13-3-请求-Servlet-时，为什么不会到达拦截器"><a href="#13-3-请求-Servlet-时，为什么不会到达拦截器" class="headerlink" title="13.3 请求 Servlet 时，为什么不会到达拦截器"></a>13.3 请求 Servlet 时，为什么不会到达拦截器</h2><h3 id="1-请求处理流程的差异"><a href="#1-请求处理流程的差异" class="headerlink" title="1. 请求处理流程的差异"></a>1. 请求处理流程的差异</h3><p>首先，我们需要理解一个关键点：<strong>在Spring Boot应用中，实际上存在两套并行的请求处理机制</strong>。</p>
<p><strong>对于Spring MVC控制器（Controller）的请求：</strong></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">HTTP</span> <span class="string">Request → Servlet Container → DispatcherServlet → 拦截器 → 控制器方法</span></span><br></pre></td></tr></table></figure>

<p><strong>对于直接映射的Servlet的请求：</strong></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">HTTP</span> <span class="string">Request → Servlet Container → 自定义Servlet</span></span><br></pre></td></tr></table></figure>



<h3 id="2-详细原因分析"><a href="#2-详细原因分析" class="headerlink" title="2. 详细原因分析"></a>2. 详细原因分析</h3><h4 id="①-DispatcherServlet-的角色定位"><a href="#①-DispatcherServlet-的角色定位" class="headerlink" title="① DispatcherServlet 的角色定位"></a>① DispatcherServlet 的角色定位</h4><ul>
<li><code>DispatcherServlet</code> 是Spring MVC的<strong>前端控制器</strong>，它是所有Spring MVC请求的<strong>统一入口</strong></li>
<li>但它<strong>不是</strong>整个Web应用的唯一Servlet</li>
<li>在Spring Boot中，<code>DispatcherServlet</code> 默认被映射到根路径 <code>/</code>，但<strong>它也会处理更具体的路径匹配</strong></li>
</ul>
<h4 id="②-Servlet-容器的处理机制"><a href="#②-Servlet-容器的处理机制" class="headerlink" title="② Servlet 容器的处理机制"></a>② Servlet 容器的处理机制</h4><p>当请求到达时，Servlet容器会根据URL路径选择最精确匹配的Servlet：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 情况1：请求匹配到自定义Servlet的路径</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/api/servlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="comment">// 请求直接到达这里，绕过DispatcherServlet</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况2：请求匹配到Controller的路径  </span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/controller&quot;)</span> <span class="comment">// 请求会经过DispatcherServlet → 拦截器 → 这里</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;controller response&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="③-拦截器的工作范围"><a href="#③-拦截器的工作范围" class="headerlink" title="③ 拦截器的工作范围"></a>③ 拦截器的工作范围</h4><p>Spring的拦截器是<strong>绑定在<code>DispatcherServlet</code>的处理流程中</strong>的：</p>
<p>java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyInterceptor</span>())</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>) <span class="comment">// 这个模式只对DispatcherServlet处理的请求有效</span></span><br><span class="line">                .excludePathPatterns(<span class="string">&quot;/api/servlet&quot;</span>); <span class="comment">// 排除Servlet路径实际上是不必要的</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-验证实验"><a href="#3-验证实验" class="headerlink" title="3. 验证实验"></a>3. 验证实验</h3><p>我们可以通过代码来验证这个现象：</p>
<p><strong>自定义Servlet</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/direct-servlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;✅ 直接访问Servlet - 请求到达&quot;</span>);</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;Response from Direct Servlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>拦截器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, </span></span><br><span class="line"><span class="params">                           HttpServletResponse response, Object handler)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;🔍 拦截器执行: &quot;</span> + request.getRequestURI());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>测试结果</strong></p>
<ul>
<li><p>访问 <code>http://localhost:8080/direct-servlet</code>：</p>
<p>text</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">✅ 直接访问Servlet - 请求到达</span><br><span class="line">// 控制台没有拦截器输出</span><br></pre></td></tr></table></figure>


</li>
<li><p>访问Controller路径时：</p>
<p>text</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">🔍 拦截器执行: /api/controller</span><br><span class="line">✅ Controller处理请求</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-解决方案"><a href="#4-解决方案" class="headerlink" title="4. 解决方案"></a>4. 解决方案</h3><p>如果希望Servlet请求也经过Spring的拦截器，有几种方式：</p>
<h4 id="方案1：使用Filter代替拦截器"><a href="#方案1：使用Filter代替拦截器" class="headerlink" title="方案1：使用Filter代替拦截器"></a>方案1：使用Filter代替拦截器</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, </span></span><br><span class="line"><span class="params">                        FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Filter处理: &quot;</span> + ((HttpServletRequest)request).getRequestURI());</span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="方案2：通过DispatcherServlet转发到Servlet"><a href="#方案2：通过DispatcherServlet转发到Servlet" class="headerlink" title="方案2：通过DispatcherServlet转发到Servlet"></a>方案2：通过DispatcherServlet转发到Servlet</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouterController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/router-to-servlet&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">routeToServlet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 这样会经过拦截器</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/direct-servlet&quot;</span>).forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="14-数据库操作"><a href="#14-数据库操作" class="headerlink" title="14 数据库操作"></a>14 数据库操作</h1><h2 id="14-1-JDBC-HikariDataSource"><a href="#14-1-JDBC-HikariDataSource" class="headerlink" title="14.1 JDBC+HikariDataSource"></a>14.1 JDBC+HikariDataSource</h2><p>演示 Spring Boot 如何通过 jdbc+HikariDataSource 完成对Mysql 操作说明: HikariDataSource : 目前市面上非常优秀的数据源, 是 springboot2 默认数据源</p>
<p>进 行 数 据 库 开 发 ， 在 pom.xml 引 入 data-jdbc starter</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="BlogkFile\source_posts\springboot学习\14.jpg"></p>
<p>Spring Boot 不知道项目要操作 Mysql 还是 Oracle ， 需要在pom.xml 指定导入数据库驱动， 并指定对应版本</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1. 引入操作 mysql 的驱动</span></span><br><span class="line"><span class="comment">2. 这个驱动版本要和你实际操作的 mysql 版本对应</span></span><br><span class="line"><span class="comment">3. 我们 spring-boot mysql 区别仲裁版本是&lt;mysql.version&gt;8.0.26&lt;/mysql.version&gt;,我们安装的是 mysql5 ,因此重新指定 mysql 驱动版本</span></span><br><span class="line"><span class="comment">4. 这个 mysql 驱动版本也可以在 pom.xml properties 指定</span></span><br><span class="line"><span class="comment">&lt;properties&gt;</span></span><br><span class="line"><span class="comment">&lt;mysql.version&gt;5.1.49&lt;/mysql.version&gt;</span></span><br><span class="line"><span class="comment">&lt;/properties&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.49<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>在 application.yml 配置操作数据源的信息</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="attr">max-file-size:</span> <span class="string">5MB</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">50MB</span></span><br><span class="line"><span class="comment">#数据源配置</span></span><br><span class="line">   <span class="attr">datasource:</span></span><br><span class="line"><span class="comment">#说明： 如果没有使用 useSSL=true, 会报红警告</span></span><br><span class="line">	 <span class="attr">url:</span></span><br><span class="line">        <span class="string">jdbc:mysql://localhost:3306/spring_boot?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true</span></span><br><span class="line">     <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">     <span class="attr">password:</span> <span class="string">hsp</span></span><br><span class="line">     <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<p><strong>创建</strong> 04_springboot_usersys\src\main\java\com\wzb\usersys\bean\Furn.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Furn</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String maker;</span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line">    <span class="keyword">private</span> Integer sales;</span><br><span class="line">    <span class="keyword">private</span> Integer stock;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">imgPath</span> <span class="operator">=</span> <span class="string">&quot;assets/images/product-image/1.jpg&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>● test 目录下的 com&#x2F;hspedu&#x2F;usersys&#x2F;ApplicationTests.java , 完成测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        BeanPropertyRowMapper&lt;Furn&gt; rowMapper =</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(Furn.class);</span><br><span class="line">        List&lt;Furn&gt; furns = jdbcTemplate.query(<span class="string">&quot;select * from furn&quot;</span>, rowMapper);</span><br><span class="line">        <span class="keyword">for</span> (Furn furn : furns) &#123;</span><br><span class="line">            System.out.println(furn);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(jdbcTemplate.getDataSource().getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="14-2-整合Druid到springboot"><a href="#14-2-整合Druid到springboot" class="headerlink" title="14.2 整合Druid到springboot"></a>14.2 整合Druid到springboot</h2><h3 id="14-2-1-基本介绍"><a href="#14-2-1-基本介绍" class="headerlink" title="14.2.1 基本介绍"></a>14.2.1 基本介绍</h3><p>Druid： 性能优秀，Druid 提供性能卓越的连接池功能外【Java 基础】，还集成了SQL监控，黑名单拦截等功能，强大的监控特性，通过 Druid 提供的监控功能，可以清楚知道连接池和 SQL 的工作情况</p>
<h3 id="14-2-2-自定义整合"><a href="#14-2-2-自定义整合" class="headerlink" title="14.2.2 自定义整合"></a>14.2.2 自定义整合</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入 druid 依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建 com&#x2F;wzb&#x2F;usersys&#x2F;config&#x2F;DruidDataSourceConfig.java 配置类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidDataSourceConfig</span> &#123;</span><br><span class="line">    <span class="comment">// 默 认 的 自 动 配 置 是 判 断 容 器中没有才会配</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(DataSource.class)</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">* 1. 默认的数据源配置是 <span class="doctag">@ConditionalOnMissingBean</span>(DataSource.class)</span></span><br><span class="line"><span class="comment">* 2. 也就是当容器中没有 DataSource 组件时，才会注入，如果我们这里配置了DataSource, 就会使用我们配置的数据源</span></span><br><span class="line"><span class="comment">* 3. &quot;spring.datasource&quot; 会将 druid 数据源的配置绑定到application.yml, 就不需要setXxx</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        <span class="meta">@ConfigurationProperties(&quot;spring.datasource&quot;)</span></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">druidDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        <span class="comment">// &quot;spring.datasource&quot; 会将 druid 数据源的配置绑定到application.yml, 就不需要setXxx</span></span><br><span class="line">        <span class="comment">// druidDataSource.setUrl();</span></span><br><span class="line">        <span class="comment">// druidDataSource.setUsername();</span></span><br><span class="line">        <span class="comment">// druidDataSource.setPassword();</span></span><br><span class="line">        <span class="keyword">return</span> druidDataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-Durid-监控功能-SQL-监控"><a href="#1-Durid-监控功能-SQL-监控" class="headerlink" title="1 Durid 监控功能-SQL 监控"></a>1 Durid 监控功能-SQL 监控</h4><p>修改 com&#x2F;wzb&#x2F;usersys&#x2F;config&#x2F;DruidDataSourceConfig.java , 增加druid 监控功能</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidDataSourceConfig</span> &#123;</span><br><span class="line">    <span class="comment">// 默 认 的 自 动 配 置 是 判 断 容 器中没有才会配@ConditionalOnMissingBean(DataSource.class)</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">* 1. 默认的数据源配置是 <span class="doctag">@ConditionalOnMissingBean</span>(DataSource.class)</span></span><br><span class="line"><span class="comment">* 2. 也就是当容器中没有 DataSource 组件时，才会注入，如果我们这里配置了DataSource, 就会使用我们配置的数据源</span></span><br><span class="line"><span class="comment">* 3. &quot;spring.datasource&quot; 会将 druid 数据源的配置绑定到application.yml, 就不需要setXxx</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties(&quot;spring.datasource&quot;)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">druidDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        <span class="comment">// &quot;spring.datasource&quot; 会将 druid 数据源的配置绑定到application.yml, 就不需要setXxx</span></span><br><span class="line">        <span class="comment">// druidDataSource.setUrl();</span></span><br><span class="line">        <span class="comment">// druidDataSource.setUsername();</span></span><br><span class="line">        <span class="comment">// druidDataSource.setPassword();</span></span><br><span class="line">        druidDataSource.setFilters(<span class="string">&quot;stat&quot;</span>)<span class="comment">// sql监控功能</span></span><br><span class="line">        <span class="keyword">return</span> druidDataSource;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">* 配置 druid 的监控页功能</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletRegistrationBean <span class="title function_">statViewServlet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StatViewServlet</span> <span class="variable">statViewServlet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StatViewServlet</span>();</span><br><span class="line">        ServletRegistrationBean&lt;StatViewServlet&gt; registrationBean =</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>&lt;&gt;(statViewServlet, <span class="string">&quot;/druid/*&quot;</span>);</span><br><span class="line">        <span class="comment">//配置登录监控页面用户名和密码</span></span><br><span class="line">        registrationBean.addInitParameter(<span class="string">&quot;loginUsername&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        registrationBean.addInitParameter(<span class="string">&quot;loginPassword&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建 com&#x2F;wzb&#x2F;usersys&#x2F;controller&#x2F;DruidSqlController.java，模拟操作 DB 的请求</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidSqlController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sql&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Furn&gt; <span class="title function_">crudDB</span><span class="params">()</span>&#123;</span><br><span class="line">        BeanPropertyRowMapper&lt;Furn&gt; rowMapper =</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(Furn.class);</span><br><span class="line">        List&lt;Furn&gt; furns = jdbcTemplate.query(<span class="string">&quot;select * from furn&quot;</span>, rowMapper);</span><br><span class="line">        <span class="keyword">for</span> (Furn furn : furns) &#123;</span><br><span class="line">            System.out.println(furn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> furns;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SQL 监控数据-测试页面</p>
<p><img src="BlogkFile\source_posts\springboot学习\15.jpg"></p>
<h4 id="2-Durid-监控功能-Web-关联监控"><a href="#2-Durid-监控功能-Web-关联监控" class="headerlink" title="2 Durid 监控功能-Web 关联监控"></a>2 Durid 监控功能-Web 关联监控</h4><p>修 改 com&#x2F;wzb&#x2F;usersys&#x2F;config&#x2F;DruidDataSourceConfig.java ，注入&#x2F; 增加 WebStatFilter 用于采集 web-jdbc 关联监控的数据</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* WebStatFilter 用于采集 web-jdbc 关联监控的数据。</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> FilterRegistrationBean <span class="title function_">webStatFilter</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">WebStatFilter</span> <span class="variable">webStatFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebStatFilter</span>();</span><br><span class="line">    FilterRegistrationBean&lt;WebStatFilter&gt; filterRegistrationBean =</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;(webStatFilter);</span><br><span class="line">    <span class="comment">//默认对所有 URL 请求监控</span></span><br><span class="line">    filterRegistrationBean.setUrlPatterns(Arrays.asList(<span class="string">&quot;/*&quot;</span>));</span><br><span class="line">    <span class="comment">//排除 URL</span></span><br><span class="line">    filterRegistrationBean.addInitParameter</span><br><span class="line">        (<span class="string">&quot;exclusions&quot;</span>, <span class="string">&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> filterRegistrationBean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="3-Durid-监控功能-SQL-防火墙"><a href="#3-Durid-监控功能-SQL-防火墙" class="headerlink" title="3 Durid 监控功能-SQL 防火墙"></a>3 Durid 监控功能-SQL 防火墙</h4><p>修改 com&#x2F;wzb&#x2F;usersys&#x2F;config&#x2F;DruidDataSourceConfig.java ，加入防火墙监控</p>
<p><img src="BlogkFile\source_posts\springboot学习\16.jpg"></p>
<h4 id="4-Durid-监控功能-其他监控"><a href="#4-Durid-监控功能-其他监控" class="headerlink" title="4 Durid 监控功能-其他监控"></a>4 Durid 监控功能-其他监控</h4><p>注册了 StatViewServlet 后，其他监控功能就已经包含了</p>
<p>✅ SQL监控 - SQL执行统计</p>
<p>✅ URL监控 - 请求URL统计</p>
<p>✅ Session监控 - Session管理</p>
<p>✅ Spring监控 - 方法执行监控（需额外配置）</p>
<p>✅ JSON API - 监控数据接口</p>
<p>✅ 基本监控信息 - JVM、系统信息等</p>
<h2 id="14-3-Druid-Spring-Boot-Starter"><a href="#14-3-Druid-Spring-Boot-Starter" class="headerlink" title="14.3 Druid Spring Boot Starter"></a>14.3 Druid Spring Boot Starter</h2><p>使用 <code>Druid Spring Boot Starter</code> 可以通过 YAML 配置更简洁地实现监控功能。</p>
<p><strong>基础依赖配置</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>application.yml 完整配置</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/your_db?useUnicode=true&amp;characterEncoding=utf8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">your_username</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">your_password</span></span><br><span class="line">    <span class="comment"># Druid 连接池配置</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="comment"># 初始化大小、最小、最大</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">20</span></span><br><span class="line">      <span class="comment"># 配置获取连接等待超时的时间</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">60000</span></span><br><span class="line">      <span class="comment"># 配置间隔多久才进行一次检测，检测需要关闭的空闲连接</span></span><br><span class="line">      <span class="attr">time-between-eviction-runs-millis:</span> <span class="number">60000</span></span><br><span class="line">      <span class="comment"># 配置一个连接在池中最小生存的时间</span></span><br><span class="line">      <span class="attr">min-evictable-idle-time-millis:</span> <span class="number">300000</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 监控配置</span></span><br><span class="line">      <span class="attr">web-stat-filter:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/*</span></span><br><span class="line">        <span class="attr">exclusions:</span> <span class="string">&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&quot;</span></span><br><span class="line">        </span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">admin</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="number">123456</span></span><br><span class="line">        <span class="attr">reset-enable:</span> <span class="literal">false</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># Session监控配置</span></span><br><span class="line">      <span class="attr">web-stat-filter:</span></span><br><span class="line">        <span class="attr">session-stat-enable:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">session-stat-max-count:</span> <span class="number">1000</span></span><br><span class="line">        </span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line">        <span class="attr">stat:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">slow-sql-millis:</span> <span class="number">2000</span></span><br><span class="line">        <span class="attr">wall:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<p><strong>可选：自定义配置类</strong></p>
<p>如果需要进行更复杂的配置，可以添加配置类：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties(&quot;spring.datasource.druid&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> DruidDataSourceBuilder.create().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>访问监控页面</strong></p>
<p>配置完成后，访问：<code>http://localhost:8080/druid</code></p>
<ul>
<li><strong>用户名</strong>: admin</li>
<li><strong>密码</strong>: 123456</li>
</ul>
<h1 id="15-springboot整合Mybatis"><a href="#15-springboot整合Mybatis" class="headerlink" title="15 springboot整合Mybatis"></a>15 springboot整合Mybatis</h1><h2 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h2><p><strong>Maven 配置</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot Starter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- MyBatis Spring Boot Starter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 数据库驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Druid 连接池 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-配置文件"><a href="#2-配置文件" class="headerlink" title="2. 配置文件"></a>2. 配置文件</h2><p><strong>application.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis_demo?useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="comment"># 连接池配置</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">60000</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 监控配置</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">admin</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">web-stat-filter:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MyBatis 配置</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="comment"># mapper.xml 文件位置</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span></span><br><span class="line">  <span class="comment"># 实体类包路径</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.example.entity</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="comment"># 开启驼峰命名转换</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># 日志实现</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>



<h2 id="3-实体类"><a href="#3-实体类" class="headerlink" title="3. 实体类"></a>3. 实体类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 构造方法、getter、setter、toString</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String username, String email, Integer age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.email = email;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// getter 和 setter 方法...</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, email=&#x27;&quot;</span> + email + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, createTime=&quot;</span> + createTime +</span><br><span class="line">                <span class="string">&quot;, updateTime=&quot;</span> + updateTime +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-Mapper-接口"><a href="#4-Mapper-接口" class="headerlink" title="4. Mapper 接口"></a>4. Mapper 接口</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 查询所有用户</span></span><br><span class="line">    <span class="meta">@Select(&quot;SELECT * FROM user&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 根据ID查询用户</span></span><br><span class="line">    <span class="meta">@Select(&quot;SELECT * FROM user WHERE id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(Long id)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 插入用户</span></span><br><span class="line">    <span class="meta">@Insert(&quot;INSERT INTO user(username, email, age, create_time, update_time) &quot; +</span></span><br><span class="line"><span class="meta">            &quot;VALUES(#&#123;username&#125;, #&#123;email&#125;, #&#123;age&#125;, NOW(), NOW())&quot;)</span></span><br><span class="line">    <span class="meta">@Options(useGeneratedKeys = true, keyProperty = &quot;id&quot;)</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insert</span><span class="params">(User user)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新用户</span></span><br><span class="line">    <span class="meta">@Update(&quot;UPDATE user SET username=#&#123;username&#125;, email=#&#123;email&#125;, age=#&#123;age&#125;, update_time=NOW() &quot; +</span></span><br><span class="line"><span class="meta">            &quot;WHERE id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">update</span><span class="params">(User user)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 删除用户</span></span><br><span class="line">    <span class="meta">@Delete(&quot;DELETE FROM user WHERE id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Long id)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 根据用户名查询</span></span><br><span class="line">    <span class="meta">@Select(&quot;SELECT * FROM user WHERE username LIKE CONCAT(&#x27;%&#x27;, #&#123;username&#125;, &#x27;%&#x27;)&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findByUsername</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-XML-Mapper-方式（可选）"><a href="#5-XML-Mapper-方式（可选）" class="headerlink" title="5. XML Mapper 方式（可选）"></a>5. XML Mapper 方式（可选）</h2><p><strong>resources&#x2F;mapper&#x2F;UserMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> </span></span><br><span class="line"><span class="meta">    <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 结果映射 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;UserResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;createTime&quot;</span> <span class="attr">column</span>=<span class="string">&quot;create_time&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;updateTime&quot;</span> <span class="attr">column</span>=<span class="string">&quot;update_time&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 复杂查询示例 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByCondition&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserResultMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT * FROM user </span><br><span class="line">        WHERE 1=1</span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null and username != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND username LIKE CONCAT(&#x27;%&#x27;, #&#123;username&#125;, &#x27;%&#x27;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND email LIKE CONCAT(&#x27;%&#x27;, #&#123;email&#125;, &#x27;%&#x27;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;minAge != null&quot;</span>&gt;</span></span><br><span class="line">            AND age &gt;= #&#123;minAge&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;maxAge != null&quot;</span>&gt;</span></span><br><span class="line">            AND age &lt;= #&#123;maxAge&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        ORDER BY create_time DESC</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 批量插入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;batchInsert&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">        INSERT INTO user(username, email, age, create_time, update_time) </span><br><span class="line">        VALUES</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;user&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">            (#&#123;user.username&#125;, #&#123;user.email&#125;, #&#123;user.age&#125;, NOW(), NOW())</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-Service-层"><a href="#6-Service-层" class="headerlink" title="6. Service 层"></a>6. Service 层</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">save</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (user.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> userMapper.insert(user);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> userMapper.update(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findByUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findByUsername(username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="7-Controller-层"><a href="#7-Controller-层" class="headerlink" title="7. Controller 层"></a>7. Controller 层</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getAllUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUserById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.findById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        userService.save(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户创建成功&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PutMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathVariable</span> Long id, <span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        user.setId(id);</span><br><span class="line">        userService.save(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户更新成功&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        userService.delete(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户删除成功&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/search&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">searchUsers</span><span class="params">(<span class="meta">@RequestParam</span> String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.findByUsername(username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="16-springboot整合Mybatis-Plus"><a href="#16-springboot整合Mybatis-Plus" class="headerlink" title="16 springboot整合Mybatis-Plus"></a>16 springboot整合Mybatis-Plus</h1><h2 id="1-添加依赖-1"><a href="#1-添加依赖-1" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h2><p><strong>Maven 配置</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot Starter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- MyBatis-Plus Starter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 数据库驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Druid 连接池 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Lombok 简化实体类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-配置文件-1"><a href="#2-配置文件-1" class="headerlink" title="2. 配置文件"></a>2. 配置文件</h2><p><strong>application.yml</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis_plus_demo?useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="comment"># 连接池配置</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">60000</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 监控配置</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">admin</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">web-stat-filter:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MyBatis-Plus 配置</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="comment"># mapper.xml 文件位置</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath*:/mapper/**/*.xml</span></span><br><span class="line">  <span class="comment"># 实体类包路径</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.example.entity</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="comment"># 开启驼峰命名转换</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># 日志实现</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="comment"># 主键类型 AUTO:数据库自增 NONE:未设置 INPUT:手动输入 ASSIGN_ID:雪花算法 ASSIGN_UUID:UUID</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">ASSIGN_ID</span></span><br><span class="line">      <span class="comment"># 逻辑删除字段名</span></span><br><span class="line">      <span class="attr">logic-delete-field:</span> <span class="string">deleted</span></span><br><span class="line">      <span class="comment"># 逻辑删除值</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span></span><br><span class="line">      <span class="comment"># 表名策略</span></span><br><span class="line">      <span class="attr">table-prefix:</span> <span class="string">t_</span></span><br></pre></td></tr></table></figure>



<h2 id="3-实体类-1"><a href="#3-实体类-1" class="headerlink" title="3. 实体类"></a>3. 实体类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;user&quot;)</span>  <span class="comment">// 指定表名</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@TableId(type = IdType.ASSIGN_ID)</span>  <span class="comment">// 雪花算法生成ID</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span>  <span class="comment">// 插入时自动填充</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span>  <span class="comment">// 插入和更新时自动填充</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@TableLogic</span>  <span class="comment">// 逻辑删除注解</span></span><br><span class="line">    <span class="keyword">private</span> Integer deleted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-Mapper-接口-1"><a href="#4-Mapper-接口-1" class="headerlink" title="4. Mapper 接口"></a>4. Mapper 接口</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class="line">    <span class="comment">// 继承 BaseMapper 就拥有了基本的 CRUD 方法</span></span><br><span class="line">    <span class="comment">// 无需编写 XML，也可以自定义方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-Service-层"><a href="#5-Service-层" class="headerlink" title="5. Service 层"></a>5. Service 层</h2><p><strong>接口</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line">    <span class="comment">// 可以自定义业务方法</span></span><br><span class="line">    User <span class="title function_">getByUsername</span><span class="params">(String username)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">updateEmail</span><span class="params">(Long id, String email)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>实现类</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getByUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(User::getUsername, username);</span><br><span class="line">        <span class="keyword">return</span> baseMapper.selectOne(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateEmail</span><span class="params">(Long id, String email)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(id);</span><br><span class="line">        user.setEmail(email);</span><br><span class="line">        <span class="keyword">return</span> updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-自动填充处理器"><a href="#6-自动填充处理器" class="headerlink" title="6. 自动填充处理器"></a>6. 自动填充处理器</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;createTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">        <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.strictUpdateFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="7-Controller-层-1"><a href="#7-Controller-层-1" class="headerlink" title="7. Controller 层"></a>7. Controller 层</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 查询所有用户</span></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getAllUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.list();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 根据ID查询用户</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUserById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 新增用户</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.save(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新用户</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathVariable</span> Long id, <span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        user.setId(id);</span><br><span class="line">        <span class="keyword">return</span> userService.updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 删除用户（逻辑删除）</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.removeById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 分页查询</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> IPage&lt;User&gt; <span class="title function_">getUserPage</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer current,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer size)</span> &#123;</span><br><span class="line">        Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size);</span><br><span class="line">        <span class="keyword">return</span> userService.page(page);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 条件查询</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/search&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">searchUsers</span><span class="params">(<span class="meta">@RequestParam</span> String username)</span> &#123;</span><br><span class="line">        LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.like(User::getUsername, username)</span><br><span class="line">               .orderByDesc(User::getCreateTime);</span><br><span class="line">        <span class="keyword">return</span> userService.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 复杂条件查询</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/condition&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getUsersByCondition</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(required = false)</span> String username,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(required = false)</span> Integer minAge,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(required = false)</span> Integer maxAge)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (username != <span class="literal">null</span> &amp;&amp; !username.isEmpty()) &#123;</span><br><span class="line">            wrapper.like(<span class="string">&quot;username&quot;</span>, username);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (minAge != <span class="literal">null</span>) &#123;</span><br><span class="line">            wrapper.ge(<span class="string">&quot;age&quot;</span>, minAge);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (maxAge != <span class="literal">null</span>) &#123;</span><br><span class="line">            wrapper.le(<span class="string">&quot;age&quot;</span>, maxAge);</span><br><span class="line">        &#125;</span><br><span class="line">        wrapper.orderByDesc(<span class="string">&quot;create_time&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> userService.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="8-配置类（可选）"><a href="#8-配置类（可选）" class="headerlink" title="8. 配置类（可选）"></a>8. 配置类（可选）</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加分页插件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="9-数据库表结构测试"><a href="#9-数据库表结构测试" class="headerlink" title="9. 数据库表结构测试"></a>9. 数据库表结构测试</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> mybatis_plus_demo;</span><br><span class="line"></span><br><span class="line">USE mybatis_plus_demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">    id <span class="type">BIGINT</span> <span class="keyword">PRIMARY KEY</span> COMMENT <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) COMMENT <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">    age <span class="type">INT</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    update_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;更新时间&#x27;</span>,</span><br><span class="line">    deleted TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;逻辑删除 0:未删除 1:已删除&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> <span class="keyword">user</span> (id, username, email, age) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;zhangsan@example.com&#x27;</span>, <span class="number">25</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;lisi@example.com&#x27;</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;wangwu@example.com&#x27;</span>, <span class="number">28</span>);</span><br></pre></td></tr></table></figure>

<h2 id="10-测试接口"><a href="#10-测试接口" class="headerlink" title="10. 测试接口"></a>10. 测试接口</h2><p>启动应用后，可以测试以下接口：</p>
<ul>
<li><code>GET /api/users</code> - 查询所有用户</li>
<li><code>GET /api/users/1</code> - 根据ID查询用户</li>
<li><code>POST /api/users</code> - 新增用户</li>
<li><code>PUT /api/users/1</code> - 更新用户</li>
<li><code>DELETE /api/users/1</code> - 删除用户（逻辑删除）</li>
<li><code>GET /api/users/page?current=1&amp;size=10</code> - 分页查询</li>
<li><code>GET /api/users/search?username=张</code> - 条件查询</li>
<li><code>GET /api/users/condition?username=张&amp;minAge=20&amp;maxAge=30</code> - 复杂条件查询</li>
</ul>
<h2 id="MyBatis-Plus-特性"><a href="#MyBatis-Plus-特性" class="headerlink" title="MyBatis-Plus 特性"></a>MyBatis-Plus 特性</h2><ol>
<li><strong>无侵入</strong>：只做增强不做改变，引入它不会对现有工程产生影响</li>
<li><strong>强大的 CRUD</strong>：内置通用 Mapper、通用 Service，少量配置即可实现单表 CRUD</li>
<li><strong>支持 Lambda</strong>：通过 Lambda 表达式，方便的编写各类查询条件</li>
<li><strong>主键策略</strong>：支持多种主键策略，可自由配置</li>
<li><strong>分页插件</strong>：内置分页插件，基于 MyBatis 物理分页</li>
<li><strong>性能分析</strong>：支持 SQL 性能分析插件</li>
<li><strong>全局拦截</strong>：提供全表删除、更新操作智能分析阻断</li>
<li><strong>逻辑删除</strong>：内置逻辑删除功能</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">明</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/07/06/springboot%E5%AD%A6%E4%B9%A0/">http://example.com/2024/07/06/springboot%E5%AD%A6%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">学习笔记</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/08/03/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%B4%E4%BD%93%E4%BB%8B%E7%BB%8D/" title="软件开发整体介绍"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">软件开发整体介绍</div></div><div class="info-2"><div class="info-item-1">1.软件开发流程  2.角色分工  3.软件环境 </div></div></div></a><a class="pagination-related" href="/2024/06/02/SSM%E6%95%B4%E5%90%88/" title="SSM整合"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">SSM整合</div></div><div class="info-2"><div class="info-item-1">SSM整合目录 一、SSM整合理解 1. 什么是SSM整合？ 2. SSM整合核心理解五连问！ 2.1 SSM整合涉及几个IoC容器？ 2.2 每个IoC容器盛放哪些组件？ 2.3 IoC容器之间是什么关系？ 2.4 需要几个配置文件和对应IoC容器关系？ 2.5 IoC容器初始化方式？     二、SSM整合配置实战 1. 依赖添加 2. 控制层配置编写(SpringMVC整合) 3. 业务层配置编写(AOP &#x2F; TX整合） 4. 持久层配置编写(MyBatis整合) 5. 容器初始化配置web.xml 6. 整合测试   三、前端程序搭建和运行 1. 案例功能和接口分析 1.1 案例功能预览 1.2 接口分析   2. 前端工程导入 3. 启动测试   四、后端程序实现和测试 1.  准备工作 2. 功能实现 3. 前后联调   五、SSM技术栈总结 1. Spring框架总结 1.1 技术点总结 1.2 配置总结 1.3 注解总结   2. Spring MVC 框架总结 2.1 技术点总结 2.2 配置总结 2.3 注解总结   3. MyBatis框架总结 3...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">明</div><div class="author-info-description">记录学习过程中的点点滴滴</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-SpringBoot%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">1.1 SpringBoot是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-SpringBoot%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-text">1.2 SpringBoot快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-%E5%B0%8F%E7%BB%93"><span class="toc-text">1.2.1 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-SpringBoot%E4%B8%8ESpringMVC%E5%85%B3%E7%B3%BB"><span class="toc-text">1.3 SpringBoot与SpringMVC关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-%E6%A2%B3%E7%90%86%E5%85%B3%E7%B3%BB"><span class="toc-text">1.3.1 梳理关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3-%E7%BA%A6%E5%AE%9A%E4%BC%98%E4%BA%8E%E9%85%8D%E7%BD%AE"><span class="toc-text">1.3.2 如何理解 -约定优于配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E5%92%8C%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">2 依赖管理和自动配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86"><span class="toc-text">2.1 依赖管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86"><span class="toc-text">2.1.1 什么是依赖管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E4%BF%AE%E6%94%B9%E8%87%AA%E5%8A%A8%E4%BB%B2%E8%A3%81-%E9%BB%98%E8%AE%A4%E7%89%88%E6%9C%AC%E5%8F%B7"><span class="toc-text">2.1.2 修改自动仲裁&#x2F;默认版本号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-starter-%E5%9C%BA%E6%99%AF%E5%90%AF%E5%8A%A8%E5%99%A8"><span class="toc-text">2.2 starter 场景启动器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-starter%E5%9C%BA%E6%99%AF%E5%90%AF%E5%8A%A8%E5%99%A8%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">2.2.1 starter场景启动器基本介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-%E5%AE%98%E6%96%B9%E6%8F%90%E4%BE%9B%E7%9A%84starter"><span class="toc-text">2.2.2 官方提供的starter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-%E7%AC%AC%E4%B8%89%E6%96%B9starter"><span class="toc-text">2.2.3 第三方starter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">2.3 自动配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8A%9F%E8%83%BD"><span class="toc-text">2.3.1 自动配置功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E6%89%AB%E6%8F%8F%E5%8C%85%E7%BB%93%E6%9E%84"><span class="toc-text">2.3.2 如何修改默认扫描包结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-3-resources-application-properties-%E9%85%8D%E7%BD%AE"><span class="toc-text">2.3.3 resources\application.properties 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-4-spring-boot-autoconfigure"><span class="toc-text">2.3.4 spring-boot-autoconfigure</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%AE%B9%E5%99%A8%E5%8A%9F%E8%83%BD"><span class="toc-text">3 容器功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Spring-%E6%B3%A8%E5%85%A5%E7%BB%84%E4%BB%B6%E7%9A%84%E6%B3%A8%E8%A7%A3"><span class="toc-text">3.1 Spring 注入组件的注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-Component%E3%80%81-Controller%E3%80%81-Service%E3%80%81-Repository"><span class="toc-text">3.1.1 @Component、@Controller、 @Service、@Repository</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Configuration"><span class="toc-text">3.2 @Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="toc-text">3.2.1 应用实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-Configuration-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E7%BB%86%E8%8A%82"><span class="toc-text">3.2.2 @Configuration 注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-Import"><span class="toc-text">3.3 @Import</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-Conditional"><span class="toc-text">3.4 @Conditional</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-Conditional-%E4%BB%8B%E7%BB%8D"><span class="toc-text">3.4.1 @Conditional 介绍</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-ImportResource"><span class="toc-text">3.5 @ImportResource</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-%E9%85%8D%E7%BD%AE%E7%BB%91%E5%AE%9A"><span class="toc-text">3.6 配置绑定</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-Lombok"><span class="toc-text">4 Lombok</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-Lomkbok%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">4.1 Lomkbok的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-Lomkbok%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-text">4.2 Lomkbok常用注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-Lombok%E5%BA%94%E7%94%A8"><span class="toc-text">4.3 Lombok应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-yaml"><span class="toc-text">5 yaml</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-yaml%E4%BB%8B%E7%BB%8D"><span class="toc-text">5.1 yaml介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-yaml%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">5.2 yaml基本语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.3 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="toc-text">5.3.1 字面量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-%E5%AF%B9%E8%B1%A1"><span class="toc-text">5.3.2 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-%E6%95%B0%E7%BB%84"><span class="toc-text">5.3.3 数组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-yaml-%E4%BD%BF%E7%94%A8%E7%BB%86%E8%8A%82"><span class="toc-text">5.4 yaml 使用细节</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE"><span class="toc-text">6 静态资源访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">6.1 基本介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F"><span class="toc-text">6.2 使用注意</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-Rest%E9%A3%8E%E6%A0%BC%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86"><span class="toc-text">7 Rest风格请求处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">7.1 基本介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E7%BB%86%E8%8A%82"><span class="toc-text">7.2 注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0%E7%9B%B8%E5%85%B3%E6%B3%A8%E8%A7%A3"><span class="toc-text">8 接收参数相关注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">8.1 基本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-PathVariable"><span class="toc-text">1. @PathVariable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-RequestHeader"><span class="toc-text">2. @RequestHeader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ModelAttribute"><span class="toc-text">3. @ModelAttribute</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-RequestParam"><span class="toc-text">4. @RequestParam</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-MatrixVariable"><span class="toc-text">5. @MatrixVariable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-CookieValue"><span class="toc-text">6. @CookieValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-RequestBody"><span class="toc-text">7. @RequestBody</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E5%A4%8D%E6%9D%82%E5%8F%82%E6%95%B0%E6%8E%A5%E6%94%B6%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE"><span class="toc-text">8.2 复杂参数接收请求数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B8%B8%E7%94%A8%E5%A4%8D%E6%9D%82%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-text">1. 常用复杂参数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Map-%E5%92%8C-Model-Request%E5%9F%9F%E6%95%B0%E6%8D%AE"><span class="toc-text">2. Map 和 Model - Request域数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-RedirectAttributes-%E9%87%8D%E5%AE%9A%E5%90%91%E6%90%BA%E5%B8%A6%E6%95%B0%E6%8D%AE"><span class="toc-text">3. RedirectAttributes - 重定向携带数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-HttpServletResponse-%E5%93%8D%E5%BA%94%E6%8E%A7%E5%88%B6"><span class="toc-text">4. HttpServletResponse - 响应控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-HttpSession-%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86"><span class="toc-text">5. HttpSession - 会话管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">6. 实际应用示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%B9%E8%B1%A1%E5%8F%82%E6%95%B0%E8%87%AA%E5%8A%A8%E5%B0%81%E8%A3%85"><span class="toc-text">8.3 自定义对象参数自动封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">1. 基本介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">2. 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BA%A7%E8%81%94%E5%B0%81%E8%A3%85%EF%BC%88%E5%B5%8C%E5%A5%97%E5%AF%B9%E8%B1%A1%EF%BC%89"><span class="toc-text">3. 级联封装（嵌套对象）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%97%E8%A1%A8%E5%92%8C%E6%95%B0%E7%BB%84%E5%B0%81%E8%A3%85"><span class="toc-text">4. 列表和数组封装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">5. 实际应用示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E5%99%A8"><span class="toc-text">9 自定义转换器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D-1"><span class="toc-text">1. 基本介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%86%85%E7%BD%AE%E8%BD%AC%E6%8D%A2%E5%99%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">2. 内置转换器示例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E5%99%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">3. 自定义转换器场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E5%99%A8"><span class="toc-text">4. 实现自定义转换器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%EF%BC%9AConverter-%E6%8E%A5%E5%8F%A3"><span class="toc-text">方式1：Converter 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%EF%BC%9A%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E7%B1%BB%E6%B3%A8%E5%86%8C"><span class="toc-text">方式2：使用配置类注册</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E5%99%A8"><span class="toc-text">5. 使用自定义转换器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E8%B0%83%E8%AF%95%E6%9F%A5%E7%9C%8B%E8%BD%AC%E6%8D%A2%E5%99%A8"><span class="toc-text">6. 调试查看转换器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E6%8B%A6%E6%88%AA%E5%99%A8-HandlerInterceptor"><span class="toc-text">10 拦截器-HandlerInterceptor</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">10.1 基本介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-%E6%8B%A6%E6%88%AA%E5%99%A8%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="toc-text">10.2 拦截器应用实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">11 文件上传</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-text">12 异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">12.1 基本介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2-%E6%8B%A6%E6%88%AA%E5%99%A8VS%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-text">12.2 拦截器VS过滤器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E9%A1%B5%E9%9D%A2"><span class="toc-text">12.3 自定义异常页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E9%9D%99%E6%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2%EF%BC%88%E6%9C%80%E7%AE%80%E5%8D%95%EF%BC%89"><span class="toc-text">方法一：静态自定义错误页面（最简单）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%8A%A8%E6%80%81%E6%A8%A1%E6%9D%BF%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="toc-text">方法二：动态模板错误页面（推荐）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A%E4%BD%BF%E7%94%A8-ControllerAdvice-%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%EF%BC%88%E6%9C%80%E7%81%B5%E6%B4%BB%EF%BC%89"><span class="toc-text">方法三：使用 @ControllerAdvice 全局异常处理（最灵活）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%9B%9B%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89-ErrorController%EF%BC%88%E5%AE%8C%E5%85%A8%E6%8E%A7%E5%88%B6%EF%BC%89"><span class="toc-text">方法四：自定义 ErrorController（完全控制）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-%E6%B3%A8%E5%85%A5-Servlet%E3%80%81Filter%E3%80%81Listener"><span class="toc-text">13 注入 Servlet、Filter、Listener</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1-%E4%BD%BF%E7%94%A8-Spring-Boot-%E6%B3%A8%E8%A7%A3%EF%BC%88%E6%9C%80%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="toc-text">13.1 使用 Spring Boot 注解（最推荐）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%B3%A8%E5%85%A5-Servlet"><span class="toc-text">1. 注入 Servlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%B3%A8%E5%85%A5-Filter"><span class="toc-text">2. 注入 Filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B3%A8%E5%85%A5-Listener"><span class="toc-text">3. 注入 Listener</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%90%AF%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%89%AB%E6%8F%8F"><span class="toc-text">4. 启用注解扫描</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-2-%E4%BD%BF%E7%94%A8-Java-Config-%E9%85%8D%E7%BD%AE%EF%BC%88%E7%81%B5%E6%B4%BB%E9%85%8D%E7%BD%AE%EF%BC%89"><span class="toc-text">13.2 使用 Java Config 配置（灵活配置）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%85%88%E5%88%9B%E5%BB%BA-Servlet%E3%80%81Filter%E3%80%81Listener-%E7%B1%BB"><span class="toc-text">1. 先创建 Servlet、Filter、Listener 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E7%B1%BB%E6%B3%A8%E5%86%8C"><span class="toc-text">2. 使用配置类注册</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-3-%E8%AF%B7%E6%B1%82-Servlet-%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E4%BC%9A%E5%88%B0%E8%BE%BE%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-text">13.3 请求 Servlet 时，为什么不会到达拦截器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-text">1. 请求处理流程的差异</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AF%A6%E7%BB%86%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90"><span class="toc-text">2. 详细原因分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A0-DispatcherServlet-%E7%9A%84%E8%A7%92%E8%89%B2%E5%AE%9A%E4%BD%8D"><span class="toc-text">① DispatcherServlet 的角色定位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A1-Servlet-%E5%AE%B9%E5%99%A8%E7%9A%84%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6"><span class="toc-text">② Servlet 容器的处理机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A2-%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%8C%83%E5%9B%B4"><span class="toc-text">③ 拦截器的工作范围</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%AA%8C%E8%AF%81%E5%AE%9E%E9%AA%8C"><span class="toc-text">3. 验证实验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">4. 解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%A1%881%EF%BC%9A%E4%BD%BF%E7%94%A8Filter%E4%BB%A3%E6%9B%BF%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-text">方案1：使用Filter代替拦截器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%A1%882%EF%BC%9A%E9%80%9A%E8%BF%87DispatcherServlet%E8%BD%AC%E5%8F%91%E5%88%B0Servlet"><span class="toc-text">方案2：通过DispatcherServlet转发到Servlet</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#14-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-text">14 数据库操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#14-1-JDBC-HikariDataSource"><span class="toc-text">14.1 JDBC+HikariDataSource</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-2-%E6%95%B4%E5%90%88Druid%E5%88%B0springboot"><span class="toc-text">14.2 整合Druid到springboot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">14.2.1 基本介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B4%E5%90%88"><span class="toc-text">14.2.2 自定义整合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Durid-%E7%9B%91%E6%8E%A7%E5%8A%9F%E8%83%BD-SQL-%E7%9B%91%E6%8E%A7"><span class="toc-text">1 Durid 监控功能-SQL 监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Durid-%E7%9B%91%E6%8E%A7%E5%8A%9F%E8%83%BD-Web-%E5%85%B3%E8%81%94%E7%9B%91%E6%8E%A7"><span class="toc-text">2 Durid 监控功能-Web 关联监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Durid-%E7%9B%91%E6%8E%A7%E5%8A%9F%E8%83%BD-SQL-%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-text">3 Durid 监控功能-SQL 防火墙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Durid-%E7%9B%91%E6%8E%A7%E5%8A%9F%E8%83%BD-%E5%85%B6%E4%BB%96%E7%9B%91%E6%8E%A7"><span class="toc-text">4 Durid 监控功能-其他监控</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-3-Druid-Spring-Boot-Starter"><span class="toc-text">14.3 Druid Spring Boot Starter</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#15-springboot%E6%95%B4%E5%90%88Mybatis"><span class="toc-text">15 springboot整合Mybatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-text">1. 添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">2. 配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-text">3. 实体类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Mapper-%E6%8E%A5%E5%8F%A3"><span class="toc-text">4. Mapper 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-XML-Mapper-%E6%96%B9%E5%BC%8F%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="toc-text">5. XML Mapper 方式（可选）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Service-%E5%B1%82"><span class="toc-text">6. Service 层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Controller-%E5%B1%82"><span class="toc-text">7. Controller 层</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#16-springboot%E6%95%B4%E5%90%88Mybatis-Plus"><span class="toc-text">16 springboot整合Mybatis-Plus</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96-1"><span class="toc-text">1. 添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="toc-text">2. 配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93%E7%B1%BB-1"><span class="toc-text">3. 实体类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Mapper-%E6%8E%A5%E5%8F%A3-1"><span class="toc-text">4. Mapper 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Service-%E5%B1%82"><span class="toc-text">5. Service 层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-text">6. 自动填充处理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Controller-%E5%B1%82-1"><span class="toc-text">7. Controller 层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E9%85%8D%E7%BD%AE%E7%B1%BB%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="toc-text">8. 配置类（可选）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%BB%93%E6%9E%84%E6%B5%8B%E8%AF%95"><span class="toc-text">9. 数据库表结构测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3"><span class="toc-text">10. 测试接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MyBatis-Plus-%E7%89%B9%E6%80%A7"><span class="toc-text">MyBatis-Plus 特性</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/13/Linux%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="Linux操作系统">Linux操作系统</a><time datetime="2024-09-13T04:02:03.000Z" title="发表于 2024-09-13 12:02:03">2024-09-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/03/%E9%A3%9F%E5%88%86%E9%80%9F%E9%80%92%E9%A1%B9%E7%9B%AE/" title="食分速递项目">食分速递项目</a><time datetime="2024-08-03T01:12:58.000Z" title="发表于 2024-08-03 09:12:58">2024-08-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/03/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%B4%E4%BD%93%E4%BB%8B%E7%BB%8D/" title="软件开发整体介绍">软件开发整体介绍</a><time datetime="2024-08-02T23:42:56.000Z" title="发表于 2024-08-03 07:42:56">2024-08-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/06/springboot%E5%AD%A6%E4%B9%A0/" title="springboot学习">springboot学习</a><time datetime="2024-07-06T12:42:13.000Z" title="发表于 2024-07-06 20:42:13">2024-07-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/02/SSM%E6%95%B4%E5%90%88/" title="SSM整合">SSM整合</a><time datetime="2024-06-02T01:14:43.000Z" title="发表于 2024-06-02 09:14:43">2024-06-02</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By 明</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>